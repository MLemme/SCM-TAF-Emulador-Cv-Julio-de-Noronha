//---------------------------------------------------------------------------
//***************************************************************************
//MAURICIO ANDRADE LEMME - ANALISTA DE SISTEMAS PLENO 1
//IPqM - INSTITUTO DE PESQUISAS DA MARINHA
//GSD - GRUPO DE SISTEMAS DIGITAIS
//FUNDEP - FUNDAÇÃO DE DESENVOLVIMENTO DA PESQUISA

//EMULADOR DE SINAIS DE COMUNICAÇÃO DA TG
//NAVIO MODELO.....: V-32 JULIO DE NORONHA (INHAUMA)
//USUÁRIO FINAL....: EQUIPE CLP
//VERSÃO INICIAL...: V001b
//MÓDULO...........: TG
//DATA DE INÍCIO...: 29.11.2017
//DATA DE PROTÓTIPO: 06.12.2017
//DATA DE TÉRMINO..:
//DATA DE ATUALIZ..:
//DESIGNAÇÃO.......: ESTE MÓDULO DO SOFTWARE TEM COMO OBJETIVO A OPERAÇÃO DA TG
//EM COPARCERIA DESTE MÓDULO ESTA O MÓDULO DE COMUNICAÇÃO MODBUS DE AUTORIA DO
//FUNCIONÁRIO FÁBIO TEIXEIRA, SUA IMPLEMENTAÇÃO É DESCONHECIDA
//***************************************************************************
#include <vcl.h>
#pragma hdrstop

#include "Principal.h"
#include "ModBusDriverLib\TModBusTCPDriver.cpp"
#include "Permissivos.h"

//----------------- ENDEREÇOS DOS EQUIPAMENTOS -----------------
//--------------------------- ARCOMB ---------------------------
String PC_HL_TBGAS_ARCOMB_QQPORTAABER           = "%MW6031.10";
String PC_HL_TBGAS_ARCOMB_PDIFAL                = "%MW6031.8";
//--------------------------- ARRESF ---------------------------
String PC_HL_TBGAS_ARRESF_QQPORTAABER           = "%MW6031.11";
String PC_HL_TBGAS_ARRESF_PDIFAL                = "%MW6031.9";
//--------------------------- ATLAS ---------------------------
String CP_HL_TBGAS_ATLAS_PARARINCHDW            = "%MW511.4";
String CP_HL_TBGAS_ATLAS_PARAREMERGHDW          = "%MW511.2";
String PC_SL_TBGAS_ATLAS_FORCEDOLIG             = "%MW8000.0";
String PC_SL_TBGAS_ATLAS_FORCEAOLIG             = "%MW8000.1";
String PC_SL_TBGAS_ATLAS_FORCEACTOLIG           = "%MW8000.2";
String PC_SL_TBGAS_ATLAS_EMREMOTO               = "%MW8000.3";
String PC_SL_TBGAS_ATLAS_ABVABT                 = "%MW8000.4";
String PC_SL_TBGAS_ATLAS_ABVFEC                 = "%MW8000.5";
String PC_SL_TBGAS_ATLAS_FORCEAO1LIG            = "%MW8000.6";
String PC_SL_TBGAS_ATLAS_FORCEAO4LIG            = "%MW8000.7";
String PC_SL_TBGAS_ATLAS_FORCEAO5LIG            = "%MW8000.8";
String PC_SL_TBGAS_ATLAS_FORCEDOADALIG          = "%MW8000.9";
String PC_SL_TBGAS_ATLAS_EMMANREM               = "%MW8000.10";
String PC_SL_TBGAS_ATLAS_DAMPERABT              = "%MW8000.11";
String PC_SL_TBGAS_ATLAS_DAMPERFECH             = "%MW8000.12";
String PC_SL_TBGAS_ATLAS_ASOVFECH               = "%MW8000.13";
String PC_SL_TBGAS_ATLAS_FLAPABT                = "%MW8000.14";
String PC_SL_TBGAS_ATLAS_FLAPFECH               = "%MW8000.15";
String PC_SL_TBGAS_ATLAS_VVEXTODABT             = "%MW8001.0";
String PC_SL_TBGAS_ATLAS_VVEXTODFECH            = "%MW8001.1";
String PC_SL_TBGAS_ATLAS_VENTLIG                = "%MW8001.2";
String PC_SL_TBGAS_ATLAS_OVERRIDE1ATIV          = "%MW8001.3";
String PC_SL_TBGAS_ATLAS_OVERRIDE2ATIV          = "%MW8001.4";
String PC_SL_TBGAS_ATLAS_FSOV1ABT               = "%MW8001.5";
String PC_SL_TBGAS_ATLAS_FSOV2ABT               = "%MW8001.6";
String PC_SL_TBGAS_ATLAS_FPVABT                 = "%MW8001.7";
String PC_SL_TBGAS_ATLAS_ODAPLICADO             = "%MW8001.8";
String PC_SL_TBGAS_ATLAS_ODCORTADO              = "%MW8001.9";
String PC_SL_TBGAS_ATLAS_ARPTDAPSELEC           = "%MW8001.10";
String PC_SL_TBGAS_ATLAS_AQCINVOLUCATIV         = "%MW8001.11";
String PC_SL_TBGAS_ATLAS_ARPTDBPSELEC           = "%MW8001.12";
String PC_SL_TBGAS_ATLAS_LIMTORQATUANDO         = "%MW8001.13";
String PC_SL_TBGAS_ATLAS_LIMPLAATUANDO          = "%MW8001.14";
String PC_SL_TBGAS_ATLAS_LIMNTPATUANDO          = "%MW8001.15";
String PC_SL_TBGAS_ATLAS_LIMT54ATUANDO          = "%MW8002.0";
String PC_SL_TBGAS_ATLAS_PLAINIBIDO             = "%MW8002.1";
String PC_SL_TBGAS_ATLAS_SENSORP54FL            = "%MW8002.2";
String PC_SL_TBGAS_ATLAS_OKPARACRANK            = "%MW8002.3";
String PC_SL_TBGAS_ATLAS_OKPARTIRCRANK          = "%MW8002.4";
String PC_SL_TBGAS_ATLAS_ATIVANDOAUXIL          = "%MW8002.5";
String PC_SL_TBGAS_ATLAS_EMMOTORIZRAP           = "%MW8002.6";
String PC_SL_TBGAS_ATLAS_DESACELQUEIMA          = "%MW8002.7";
String PC_SL_TBGAS_ATLAS_ACELPRAQUEIMA          = "%MW8002.8";
String PC_SL_TBGAS_ATLAS_APLICANDOOD            = "%MW8002.9";
String PC_SL_TBGAS_ATLAS_ACELPRARALANTI         = "%MW8002.10";
String PC_SL_TBGAS_ATLAS_AQCTGEMRALANTI         = "%MW8002.11";
String PC_SL_TBGAS_ATLAS_EMOPERACAO             = "%MW8002.12";
String PC_SL_TBGAS_ATLAS_RESFEMRALANTI          = "%MW8002.13";
String PC_SL_TBGAS_ATLAS_EMCOASTDOWN            = "%MW8002.14";
String PC_SL_TBGAS_ATLAS_PARADA                 = "%MW8002.15";
String PC_SL_TBGAS_ATLAS_FORADESERVICO          = "%MW8003.0";
String PC_SL_TBGAS_ATLAS_PURGPOSFLACEND         = "%MW8003.1";
String PC_SL_TBGAS_ATLAS_PURGAMOTLENTA          = "%MW8003.2";
String PC_SL_TBGAS_ATLAS_TGDESLIGADAQTE         = "%MW8003.4";
String PC_SL_TBGAS_ATLAS_EMSIMULACAO            = "%MW8003.5";
String PC_SL_TBGAS_ATLAS_SIMULCMDOS             = "%MW8003.6";
String PC_SL_TBGAS_ATLAS_PRDAOKMOTORIZ          = "%MW8003.7";
String PC_SL_TBGAS_ATLAS_PRDADOKPARTIR          = "%MW8003.8";
String PC_SL_TBGAS_ATLAS_ARRANQUEOK             = "%MW8003.9";
String PC_SL_TBGAS_ATLAS_MINDEMPLA              = "%MW8003.10";
String PC_SL_TBGAS_ATLAS_CMDMOTPTDATV           = "%MW8003.11";
String PC_SL_TBGAS_ATLAS_CMDPTDRAPATV           = "%MW8003.12";
String PC_SL_TBGAS_ATLAS_MOTORIZBPSEL           = "%MW8003.13";
String PC_SL_TBGAS_ATLAS_MOTORIZAPSEL           = "%MW8003.14";
String PC_SL_TBGAS_ATLAS_PTDNORMSEL             = "%MW8003.15";
String PC_SL_TBGAS_ATLAS_PTDRAPSEL              = "%MW8004.0";
String PC_SL_TBGAS_ATLAS_AUXOKPTD               = "%MW8004.1";
String PC_SL_TBGAS_ATLAS_ARRANQUERPMAL          = "%MW8004.2";
String PC_SL_TBGAS_ATLAS_PRDNORMSEL             = "%MW8004.3";
String PC_SL_TBGAS_ATLAS_ACENDIMENTOOK          = "%MW8004.4";
String PC_SL_TBGAS_ATLAS_SENSORT2FL             = "%MW8004.5";
String PC_SL_TBGAS_ATLAS_TGVIRANDO              = "%MW8004.6";
String PC_SL_TBGAS_ATLAS_PERMPTDLUBOK           = "%MW8004.7";
String PC_SL_TBGAS_ATLAS_PERMPTDSPNTPBX         = "%MW8004.8";
String PC_SL_TBGAS_ATLAS_PLAEMIDLE              = "%MW8004.9";
String PC_SL_TBGAS_ATLAS_PERMPTDSISOK           = "%MW8004.11";
String PC_SL_TBGAS_ATLAS_PERMPTDNGGBX           = "%MW8004.12";
String PC_SL_TBGAS_ATLAS_DISPARHALABORT         = "%MW8004.13";
String PC_SL_TBGAS_ATLAS_PERMPTDOLNVOK          = "%MW8004.14";
String PC_SL_TBGAS_ATLAS_PLAEMMAN               = "%MW8004.15";
String PC_SL_TBGAS_ATLAS_VVEXTODEMMAN           = "%MW8005.0";
String PC_SL_TBGAS_ATLAS_HALINIBIDOINV          = "%MW8005.1";
String PC_SL_TBGAS_ATLAS_VENTEMMAN              = "%MW8005.2";
String PC_SL_TBGAS_ATLAS_PERMPTDNAVIOOK         = "%MW8005.3";
String PC_SL_TBGAS_ATLAS_PERMPTDIGNOK           = "%MW8005.4";
String PC_SL_TBGAS_ATLAS_PERMPTDINVOK           = "%MW8005.5";
String PC_SL_TBGAS_ATLAS_PERMPTDTGFRIA          = "%MW8005.6";
String PC_SL_TBGAS_ATLAS_IGNICAOLIG             = "%MW8005.7";
String PC_SL_TBGAS_ATLAS_PERMPTDODPOK           = "%MW8005.8";
String PC_SL_TBGAS_ATLAS_PERMPTDODTOK           = "%MW8005.9";
String PC_SL_TBGAS_ATLAS_GGNOGGVIBAL1           = "%MW8005.10";
String PC_SL_TBGAS_ATLAS_GGNOTPVIBAL1           = "%MW8005.11";
String PC_SL_TBGAS_ATLAS_GGNOGGVIBAL2           = "%MW8005.12";
String PC_SL_TBGAS_ATLAS_GGNOTPVIBAL2           = "%MW8005.13";
String PC_SL_TBGAS_ATLAS_TPNOGGVIBAL1           = "%MW8005.14";
String PC_SL_TBGAS_ATLAS_TPNOTPVIBAL1           = "%MW8005.15";
String PC_SL_TBGAS_ATLAS_TPNOGGVIBAL2           = "%MW8006.0";
String PC_SL_TBGAS_ATLAS_TPNOTPVIBAL2           = "%MW8006.1";
String PC_SL_TBGAS_ATLAS_PERMPTDATLASOK         = "%MW8006.2";
String PC_SL_TBGAS_ATLAS_FSOV1EMMAN             = "%MW8006.3";
String PC_SL_TBGAS_ATLAS_FSOV2EMMAN             = "%MW8006.4";
String PC_SL_TBGAS_ATLAS_FPVEMMAN               = "%MW8006.5";
String PC_SL_TBGAS_ATLAS_IGNICAOEMMAN           = "%MW8006.6";
String PC_SL_TBGAS_ATLAS_PORTAINSP1ABT          = "%MW8006.7";
String PC_SL_TBGAS_ATLAS_PORTAINSP2ABT          = "%MW8006.8";
String PC_SL_TBGAS_ATLAS_LIMITENPTATIVO         = "%MW8006.9";
String PC_SL_TBGAS_ATLAS_TODOSEMAUTO            = "%MW8006.10";
String PC_SL_TBGAS_ATLAS_QUALQUERALARME         = "%MW8006.11";
String PC_SL_TBGAS_ATLAS_OLPBX                  = "%MW8006.12";
String PC_SL_TBGAS_ATLAS_P2SENSORFL             = "%MW8006.13";
String PC_SL_TBGAS_ATLAS_PS3AL                  = "%MW8006.14";
String PC_SL_TBGAS_ATLAS_NGGSENSORAFL           = "%MW8006.15";
String PC_SL_TBGAS_ATLAS_NGGSENSORBFL           = "%MW8007.0";
String PC_SL_TBGAS_ATLAS_NGGMPUABDIF            = "%MW8007.1";
String PC_SL_TBGAS_ATLAS_NGGAL                  = "%MW8007.2";
String PC_SL_TBGAS_ATLAS_NTPSENSORAFL           = "%MW8007.3";
String PC_SL_TBGAS_ATLAS_NTPSENSORBFL           = "%MW8007.4";
String PC_SL_TBGAS_ATLAS_NTPSENSORESDIF         = "%MW8007.5";
String PC_SL_TBGAS_ATLAS_P54MEDCALCDIF          = "%MW8007.6";
String PC_SL_TBGAS_ATLAS_P54SENSORFL            = "%MW8007.7";
String PC_SL_TBGAS_ATLAS_T2SENSORAFL            = "%MW8007.8";
String PC_SL_TBGAS_ATLAS_T2SENSORBFL            = "%MW8007.9";
String PC_SL_TBGAS_ATLAS_T2SENSOREABDIF         = "%MW8007.10";
String PC_SL_TBGAS_ATLAS_T2SENSORESABFL         = "%MW8007.11";
String PC_SL_TBGAS_ATLAS_T54AL                  = "%MW8007.12";
String PC_SL_TBGAS_ATLAS_EMMAN                  = "%MW8007.13";
String PC_SL_TBGAS_ATLAS_VIBSENSORGGAL          = "%MW8007.14";
String PC_SL_TBGAS_ATLAS_VIBSENSORTPAL          = "%MW8007.15";
String PC_SL_TBGAS_ATLAS_ABVABRIRFL             = "%MW8008.0";
String PC_SL_TBGAS_ATLAS_ABVFECHARFL            = "%MW8008.1";
String PC_SL_TBGAS_ATLAS_ASOVABRIRFL            = "%MW8008.2";
String PC_SL_TBGAS_ATLAS_FLAPABRIRFL            = "%MW8008.3";
String PC_SL_TBGAS_ATLAS_FLAPFECHARFL           = "%MW8008.4";
String PC_SL_TBGAS_ATLAS_HALINIBIDO             = "%MW8008.5";
String PC_SL_TBGAS_ATLAS_HALDISPARADO           = "%MW8008.6";
String PC_SL_TBGAS_ATLAS_DETINCENDIOFL          = "%MW8008.7";
String PC_SL_TBGAS_ATLAS_MONVIBRACAOFL          = "%MW8008.8";
String PC_SL_TBGAS_ATLAS_OVERRIDE1LOC           = "%MW8008.9";
String PC_SL_TBGAS_ATLAS_OVERRIDE2LOC           = "%MW8008.10";
String PC_SL_TBGAS_ATLAS_AQCINVOLTAL            = "%MW8008.11";
String PC_SL_TBGAS_ATLAS_ALTEMPINVOL1           = "%MW8008.12";
String PC_SL_TBGAS_ATLAS_ALTEMPINVOL2           = "%MW8008.13";
String PC_SL_TBGAS_ATLAS_DETCONGARFL            = "%MW8008.14";
String PC_SL_TBGAS_ATLAS_VOLTSOLENFL            = "%MW8008.15";
String PC_SL_TBGAS_ATLAS_DAMPERABRIRFL          = "%MW8009.0";
String PC_SL_TBGAS_ATLAS_DAMPERFECHARFL         = "%MW8009.1";
String PC_SL_TBGAS_ATLAS_ASOVFECHARFL           = "%MW8009.2";
String PC_SL_TBGAS_ATLAS_TORQUEAL               = "%MW8009.3";
String PC_SL_TBGAS_ATLAS_DETINCENDIODES         = "%MW8009.4";
String PC_SL_TBGAS_ATLAS_VENTLIGARFL            = "%MW8009.5";
String PC_SL_TBGAS_ATLAS_VENTDESLIGARFL         = "%MW8009.6";
String PC_SL_TBGAS_ATLAS_VENTSOBRECARGA         = "%MW8009.7";
String PC_SL_TBGAS_ATLAS_VENTSOBRETEMP          = "%MW8009.8";
String PC_SL_TBGAS_ATLAS_FLAPSOBRECARGA         = "%MW8009.9";
String PC_SL_TBGAS_ATLAS_PLAFL                  = "%MW8009.10";
String PC_SL_TBGAS_ATLAS_ARRESFPDIFAL           = "%MW8009.11";
String PC_SL_TBGAS_ATLAS_ARRESFPDIFMTAL         = "%MW8009.12";
String PC_SL_TBGAS_ATLAS_OLRETPDIFAL            = "%MW8009.13";
String PC_SL_TBGAS_ATLAS_OLRETPDIFMTAL          = "%MW8009.14";
String PC_SL_TBGAS_ATLAS_BBAODPDIFAL            = "%MW8009.15";
String PC_SL_TBGAS_ATLAS_BBAODPDIFMTAL          = "%MW8010.0";
String PC_SL_TBGAS_ATLAS_OLSUPPDIFAL            = "%MW8010.1";
String PC_SL_TBGAS_ATLAS_OLSUPPDIFMTAL          = "%MW8010.2";
String PC_SL_TBGAS_ATLAS_OLNVBX                 = "%MW8010.3";
String PC_SL_TBGAS_ATLAS_OLNVAL                 = "%MW8010.4";
String PC_SL_TBGAS_ATLAS_ODEXTPBX               = "%MW8010.5";
String PC_SL_TBGAS_ATLAS_ODEXTPAL               = "%MW8010.6";
String PC_SL_TBGAS_ATLAS_ODMANIFPBX             = "%MW8010.7";
String PC_SL_TBGAS_ATLAS_ODMANIFPAL             = "%MW8010.8";
String PC_SL_TBGAS_ATLAS_ODEXTTBX               = "%MW8010.9";
String PC_SL_TBGAS_ATLAS_ODEXTTAL               = "%MW8010.10";
String PC_SL_TBGAS_ATLAS_OLRETATAL              = "%MW8010.11";
String PC_SL_TBGAS_ATLAS_OLRETBTAL              = "%MW8010.12";
String PC_SL_TBGAS_ATLAS_OLRETCTAL              = "%MW8010.13";
String PC_SL_TBGAS_ATLAS_OLRETDTAL              = "%MW8010.14";
String PC_SL_TBGAS_ATLAS_OLRETETAL              = "%MW8010.15";
String PC_SL_TBGAS_ATLAS_TOLRETASENSFL          = "%MW8011.0";
String PC_SL_TBGAS_ATLAS_TOLRETBSENSFL          = "%MW8011.1";
String PC_SL_TBGAS_ATLAS_TOLRETCSENSFL          = "%MW8011.2";
String PC_SL_TBGAS_ATLAS_TOLRETDSENSFL          = "%MW8011.3";
String PC_SL_TBGAS_ATLAS_TOLRETESENSFL          = "%MW8011.4";
String PC_SL_TBGAS_ATLAS_OLMODLUBSAITAL         = "%MW8011.5";
String PC_SL_TBGAS_ATLAS_OLMODLUBRTDFL          = "%MW8011.6";
String PC_SL_TBGAS_ATLAS_PS3SENSAFL             = "%MW8011.7";
String PC_SL_TBGAS_ATLAS_PS3SENSBFL             = "%MW8011.8";
String PC_SL_TBGAS_ATLAS_PS3SENSABDIF           = "%MW8011.9";
String PC_SL_TBGAS_ATLAS_DISPHALFL              = "%MW8011.10";
String PC_SL_TBGAS_ATLAS_ALPORTA1INVABT         = "%MW8011.11";
String PC_SL_TBGAS_ATLAS_ALPORTA2INVABT         = "%MW8011.12";
String PC_SL_TBGAS_ATLAS_INCENDIOTG             = "%MW8011.13";
String PC_SL_TBGAS_ATLAS_OVERRIDE1REM           = "%MW8011.14";
String PC_SL_TBGAS_ATLAS_OVERRIDE2REM           = "%MW8011.15";
String PC_SL_TBGAS_ATLAS_GGNOGGVIB              = "%MW8012.0";
String PC_SL_TBGAS_ATLAS_TPVIBALDIR             = "%MW8012.1";
String PC_SL_TBGAS_ATLAS_TPNOTPVIB              = "%MW8012.2";
String PC_SL_TBGAS_ATLAS_TPNOGGVIB              = "%MW8012.3";
String PC_SL_TBGAS_ATLAS_MONVIBDES              = "%MW8012.4";
String PC_SL_TBGAS_ATLAS_OLRETPAL               = "%MW8012.5";
String PC_SL_TBGAS_ATLAS_POLRETSENSFL           = "%MW8012.6";
String PC_SL_TBGAS_ATLAS_T54SENSFL              = "%MW8012.7";
String PC_SL_TBGAS_ATLAS_NTPAL                  = "%MW8012.8";
String PC_SL_TBGAS_ATLAS_TODINTSENSFL           = "%MW8012.9";
String PC_SL_TBGAS_ATLAS_PODEXTSENSFL           = "%MW8012.10";
String PC_SL_TBGAS_ATLAS_PODMANIFSENSFL         = "%MW8012.11";
String PC_SL_TBGAS_ATLAS_PDFILTODSENSFL         = "%MW8012.12";
String PC_SL_TBGAS_ATLAS_PDARRESFSENSFL         = "%MW8012.13";
String PC_SL_TBGAS_ATLAS_PDOLSUPSENSFL          = "%MW8012.14";
String PC_SL_TBGAS_ATLAS_PDOLRETSENSFL          = "%MW8012.15";
String PC_SL_TBGAS_ATLAS_PTDTGT54AL             = "%MW8013.0";
String PC_SL_TBGAS_ATLAS_ALMANUALINCEND         = "%MW8013.1";
String PC_SL_TBGAS_ATLAS_ARCOMBPDIFAL           = "%MW8013.2";
String PC_SL_TBGAS_ATLAS_ARCOMPDIFMTAL          = "%MW8013.3";
String PC_SL_TBGAS_ATLAS_PDARCOMBSENSFL         = "%MW8013.4";
String PC_SL_TBGAS_ATLAS_POLSENSFLBO            = "%MW8013.5";
String PC_SL_TBGAS_ATLAS_OLPMBXBO               = "%MW8013.6";
String PC_SL_TBGAS_ATLAS_PS3SENSFLBO            = "%MW8013.7";
String PC_SL_TBGAS_ATLAS_STALLDOGGBO            = "%MW8013.8";
String PC_SL_TBGAS_ATLAS_NGGSOBREVBO            = "%MW8013.9";
String PC_SL_TBGAS_ATLAS_NGGFLBO                = "%MW8013.10";
String PC_SL_TBGAS_ATLAS_NTPSOBREVBO            = "%MW8013.11";
String PC_SL_TBGAS_ATLAS_NTPFLBO                = "%MW8013.12";
String PC_SL_TBGAS_ATLAS_T54TALBO               = "%MW8013.13";
String PC_SL_TBGAS_ATLAS_SOBCORFSOV1BO          = "%MW8013.14";
String PC_SL_TBGAS_ATLAS_SUBCORFSOV1BO          = "%MW8013.15";
String PC_SL_TBGAS_ATLAS_SOBCORFSOV2BO          = "%MW8014.0";
String PC_SL_TBGAS_ATLAS_SUBCORFSOV2BO          = "%MW8014.1";
String PC_SL_TBGAS_ATLAS_T54SENSAUSBO           = "%MW8014.2";
String PC_SL_TBGAS_ATLAS_SOBCORFPVBO            = "%MW8014.3";
String PC_SL_TBGAS_ATLAS_SUBCORFPVBO            = "%MW8014.4";
String PC_SL_TBGAS_ATLAS_SENSGGVIBMALBO         = "%MW8014.5";
String PC_SL_TBGAS_ATLAS_SENSTPVIBMALBO         = "%MW8014.6";
String PC_SL_TBGAS_ATLAS_PTDNGG1200FLBO         = "%MW8014.7";
String PC_SL_TBGAS_ATLAS_PTDNGG4500FLBO         = "%MW8014.8";
String PC_SL_TBGAS_ATLAS_PTDT54BXBO             = "%MW8014.9";
String PC_SL_TBGAS_ATLAS_PRDEMHDWREMBO          = "%MW8014.10";
String PC_SL_TBGAS_ATLAS_PRDEMHDWLOCBO          = "%MW8014.11";
String PC_SL_TBGAS_ATLAS_PRDINHDWREMBO          = "%MW8014.12";
String PC_SL_TBGAS_ATLAS_PRDINHDWLOCBO          = "%MW8014.13";
String PC_SL_TBGAS_ATLAS_VEXTODABTFLBO          = "%MW8014.14";
String PC_SL_TBGAS_ATLAS_VEXTODFECHFLBO         = "%MW8014.15";
String PC_SL_TBGAS_ATLAS_ASOVABTFLBO            = "%MW8015.0";
String PC_SL_TBGAS_ATLAS_ASOVFECHFLBO           = "%MW8015.1";
String PC_SL_TBGAS_ATLAS_INCENDIOINVBO          = "%MW8015.2";
String PC_SL_TBGAS_ATLAS_ODEXTPMBXBO            = "%MW8015.3";
String PC_SL_TBGAS_ATLAS_MANIFPMBXBO            = "%MW8015.4";
String PC_SL_TBGAS_ATLAS_OLRETAMALBO            = "%MW8015.5";
String PC_SL_TBGAS_ATLAS_OLRETBMALBO            = "%MW8015.6";
String PC_SL_TBGAS_ATLAS_OLRETCMALBO            = "%MW8015.7";
String PC_SL_TBGAS_ATLAS_OLRETDMALBO            = "%MW8015.8";
String PC_SL_TBGAS_ATLAS_OLRETEMALBO            = "%MW8015.9";
String PC_SL_TBGAS_ATLAS_NGGHDWTRIPBO           = "%MW8015.10";
String PC_SL_TBGAS_ATLAS_NTPHDWTRIPBO           = "%MW8015.11";
String PC_SL_TBGAS_ATLAS_SOBRETORQUEBO          = "%MW8015.12";
String PC_SL_TBGAS_ATLAS_GGVIBMALDIRBO          = "%MW8015.13";
String PC_SL_TBGAS_ATLAS_GGNOGGVIBMALBO         = "%MW8015.14";
String PC_SL_TBGAS_ATLAS_TPNOGGVIBMALBO         = "%MW8015.15";
String PC_SL_TBGAS_ATLAS_TPVIBMALDIRBO          = "%MW8016.0";
String PC_SL_TBGAS_ATLAS_TPNOTPVIBMALBO         = "%MW8016.1";
String PC_SL_TBGAS_ATLAS_GGNOTPVIBMALBO         = "%MW8016.2";
String PC_SL_TBGAS_ATLAS_PRDEMERGHMIBO          = "%MW8016.3";
String PC_SL_TBGAS_ATLAS_PRDINCLOCHMIBO         = "%MW8016.4";
String PC_SL_TBGAS_ATLAS_LNGVIBSENSGGBO         = "%MW8016.5";
String PC_SL_TBGAS_ATLAS_LNGVIBSENSTPBO         = "%MW8016.6";
String PC_SL_TBGAS_ATLAS_OUTSFORCADASBO         = "%MW8016.7";
String PC_SL_TBGAS_ATLAS_PTDMANIFPALBO          = "%MW8016.8";
String PC_SL_TBGAS_ATLAS_PTDT54MALBO            = "%MW8016.9";
String PC_SL_TBGAS_ATLAS_OPERT54BXBO            = "%MW8016.10";
String PC_SL_TBGAS_ATLAS_PRDEMERGSCMBO          = "%MW8016.11";
String PC_SL_TBGAS_ATLAS_PRDINCSCMBO            = "%MW8016.12";
String PC_SL_TBGAS_ATLAS_PTDATIVAUXFLBO         = "%MW8016.13";
String PC_SL_TBGAS_ATLAS_HALDISPARANDO          = "%MW8016.14";
String PC_SL_TBGAS_ATLAS_QQALARMEHDW            = "%MW8016.15";
String PC_SL_TBGAS_ATLAS_QQALARMESFW            = "%MW8017.0";
String PC_SL_TBGAS_ATLAS_COM2CPUFL              = "%MW8017.1";
String PC_SL_TBGAS_ATLAS_COMUNHMIFL             = "%MW8017.2";
String PC_SL_TBGAS_ATLAS_MODBUSFL               = "%MW8017.3";
String PC_SL_TBGAS_ATLAS_RS485SCMFL             = "%MW8017.4";
String PC_SL_TBGAS_ATLAS_CALCTORQUEFL           = "%MW8017.5";
String PC_SL_TBGAS_ATLAS_MONVIBCOMUNFL          = "%MW8017.6";
String PC_SL_TBGAS_ATLAS_ADAMCOMUNFL            = "%MW8017.7";
String PC_SL_TBGAS_ATLAS_COM1SMARTFL            = "%MW8017.8";
String PC_SL_TBGAS_ATLAS_COM2SMARTFL            = "%MW8017.9";
String PC_SL_TBGAS_ATLAS_COM3SMARTFL            = "%MW8017.10";
String PC_SL_TBGAS_ATLAS_MODCTRALIMELBX         = "%MW8017.11";
String PC_SL_TBGAS_ATLAS_COMBO1FL               = "%MW8017.12";
String PC_SL_TBGAS_ATLAS_COMBO2FL               = "%MW8017.13";
String PC_SL_TBGAS_ATLAS_COMBO3FL               = "%MW8017.14";
String PC_SL_TBGAS_ATLAS_RELOGIOCPUFL           = "%MW8017.15";
String PC_SL_TBGAS_ATLAS_VARTUNABLEFL           = "%MW8018.0";
String PC_SL_TBGAS_ATLAS_TENSAOALIMAL           = "%MW8018.1";
String PC_SL_TBGAS_ATLAS_CARTAOSMARTFL          = "%MW8018.2";
String PC_SL_TBGAS_ATLAS_SMARTAI1FL             = "%MW8018.3";
String PC_SL_TBGAS_ATLAS_SMARTAI2FL             = "%MW8018.4";
String PC_SL_TBGAS_ATLAS_SMARTAI3FL             = "%MW8018.5";
String PC_SL_TBGAS_ATLAS_SMARTAI4FL             = "%MW8018.6";
String PC_SL_TBGAS_ATLAS_SMARTAI5FL             = "%MW8018.7";
String PC_SL_TBGAS_ATLAS_SMARTAI6FL             = "%MW8018.8";
String PC_SL_TBGAS_ATLAS_SMARTOUTATU1FL         = "%MW8018.9";
String PC_SL_TBGAS_ATLAS_SMARTOUTATU2FL         = "%MW8018.10";
String PC_SL_TBGAS_ATLAS_COMBO1AI1FL            = "%MW8018.11";
String PC_SL_TBGAS_ATLAS_COMBO1AI2FL            = "%MW8018.12";
String PC_SL_TBGAS_ATLAS_COMBO1AI3FL            = "%MW8018.13";
String PC_SL_TBGAS_ATLAS_COMBO1AI4FL            = "%MW8018.14";
String PC_SL_TBGAS_ATLAS_COMBO1AI5FL            = "%MW8018.15";
String PC_SL_TBGAS_ATLAS_COMBO1AI6FL            = "%MW8019.0";
String PC_SL_TBGAS_ATLAS_COMBO1AI7FL            = "%MW8019.1";
String PC_SL_TBGAS_ATLAS_COMBO1AI8FL            = "%MW8019.2";
String PC_SL_TBGAS_ATLAS_COMBO1AI9FL            = "%MW8019.3";
String PC_SL_TBGAS_ATLAS_COMBO1AI10FL           = "%MW8019.4";
String PC_SL_TBGAS_ATLAS_COMBO1AI11FL           = "%MW8019.5";
String PC_SL_TBGAS_ATLAS_COMBO1AI12FL           = "%MW8019.6";
String PC_SL_TBGAS_ATLAS_COMBO1AI13FL           = "%MW8019.7";
String PC_SL_TBGAS_ATLAS_COMBO1AI14FL           = "%MW8019.8";
String PC_SL_TBGAS_ATLAS_COMBO1AI15FL           = "%MW8019.9";
String PC_SL_TBGAS_ATLAS_COMBO1AI16FL           = "%MW8019.10";
String PC_SL_TBGAS_ATLAS_COMBO2AI1FL            = "%MW8019.11";
String PC_SL_TBGAS_ATLAS_COMBO2AI2FL            = "%MW8019.12";
String PC_SL_TBGAS_ATLAS_COMBO2AI3FL            = "%MW8019.13";
String PC_SL_TBGAS_ATLAS_COMBO2AI4FL            = "%MW8019.14";
String PC_SL_TBGAS_ATLAS_COMBO2AI5FL            = "%MW8019.15";
String PC_SL_TBGAS_ATLAS_COMBO2AI6FL            = "%MW8020.0";
String PC_SL_TBGAS_ATLAS_COMBO2AI7FL            = "%MW8020.1";
String PC_SL_TBGAS_ATLAS_COMBO2AI8FL            = "%MW8020.2";
String PC_SL_TBGAS_ATLAS_COMBO2AI9FL            = "%MW8020.3";
String PC_SL_TBGAS_ATLAS_COMBO2AI10FL           = "%MW8020.4";
String PC_SL_TBGAS_ATLAS_COMBO2AI11RGFL         = "%MW8020.5";
String PC_SL_TBGAS_ATLAS_COMBO2AI11TPFL         = "%MW8020.6";
String PC_SL_TBGAS_ATLAS_COMBO2AI12FL           = "%MW8020.7";
String PC_SL_TBGAS_ATLAS_COMBO2AI13FL           = "%MW8020.8";
String PC_SL_TBGAS_ATLAS_COMBO2AI14FL           = "%MW8020.9";
String PC_SL_TBGAS_ATLAS_COMBO2AI15FL           = "%MW8020.10";
String PC_SL_TBGAS_ATLAS_COMBO2AI16FL           = "%MW8020.11";
String PC_SL_TBGAS_ATLAS_COMBO3AI1RGFL          = "%MW8020.12";
String PC_SL_TBGAS_ATLAS_COMBO3AI1TPFL          = "%MW8020.13";
String PC_SL_TBGAS_ATLAS_COMBO3AI2RGFL          = "%MW8020.14";
String PC_SL_TBGAS_ATLAS_COMBO3AI2TPFL          = "%MW8020.15";
String PC_SL_TBGAS_ATLAS_COMBO3AI3RGFL          = "%MW8021.0";
String PC_SL_TBGAS_ATLAS_COMBO3AI3TPFL          = "%MW8021.1";
String PC_SL_TBGAS_ATLAS_COMBO3AI4RGFL          = "%MW8021.2";
String PC_SL_TBGAS_ATLAS_COMBO3AI4TPFL          = "%MW8021.3";
String PC_SL_TBGAS_ATLAS_COMBO3AI5RGFL          = "%MW8021.4";
String PC_SL_TBGAS_ATLAS_COMBO3AI5TPFL          = "%MW8021.5";
String PC_SL_TBGAS_ATLAS_COMBO3AI6RGFL          = "%MW8021.6";
String PC_SL_TBGAS_ATLAS_COMBO3AI6TPFL          = "%MW8021.7";
String PC_SL_TBGAS_ATLAS_COMBO3AI7RGFL          = "%MW8021.8";
String PC_SL_TBGAS_ATLAS_COMBO3AI7TPFL          = "%MW8021.9";
String PC_SL_TBGAS_ATLAS_COMBO3AI8RGFL          = "%MW8021.10";
String PC_SL_TBGAS_ATLAS_COMBO3AI8TPFL          = "%MW8021.11";
String PC_SL_TBGAS_ATLAS_COMBO3AI9RGFL          = "%MW8021.12";
String PC_SL_TBGAS_ATLAS_COMBO3AI9TPFL          = "%MW8021.13";
String PC_SL_TBGAS_ATLAS_COMBO3AI10RGFL         = "%MW8021.14";
String PC_SL_TBGAS_ATLAS_COMBO3AI10TPFL         = "%MW8021.15";
String PC_SL_TBGAS_ATLAS_COMBO3AI11RGFL         = "%MW8022.0";
String PC_SL_TBGAS_ATLAS_COMBO3AI11TPFL         = "%MW8022.1";
String PC_SL_TBGAS_ATLAS_COMBO3AI12FL           = "%MW8022.2";
String PC_SL_TBGAS_ATLAS_COMBO3AI13FL           = "%MW8022.3";
String PC_SL_TBGAS_ATLAS_COMBO3AI14FL           = "%MW8022.4";
String PC_SL_TBGAS_ATLAS_COMBO3AI15FL           = "%MW8022.5";
String PC_SL_TBGAS_ATLAS_COMBO3AI16FL           = "%MW8022.6";
String PC_SL_TBGAS_ATLAS_LINKCOMHMIFL           = "%MW8022.7";
String PC_SL_TBGAS_ATLAS_PROTCOMHMIFL           = "%MW8022.8";
String PC_SL_TBGAS_ATLAS_LINK1COMSCMFL          = "%MW8022.9";
String PC_SL_TBGAS_ATLAS_PROT1COMSCMFL          = "%MW8022.10";
String PC_SL_TBGAS_ATLAS_LINK2COMSCMFL          = "%MW8022.11";
String PC_SL_TBGAS_ATLAS_PROT2COMSCMFL          = "%MW8022.12";
String PC_SL_TBGAS_ATLAS_LINKCOMADAM1FL         = "%MW8022.13";
String PC_SL_TBGAS_ATLAS_PROTCOMADAM1FL         = "%MW8022.14";
String PC_SL_TBGAS_ATLAS_LINKCOMADAM2FL         = "%MW8022.15";
String PC_SL_TBGAS_ATLAS_PROTCOMADAM2FL         = "%MW8023.0";
String PC_SL_TBGAS_ATLAS_LINKCOMBENTLFL         = "%MW8023.1";
String PC_SL_TBGAS_ATLAS_PROTCOMBENTLFL         = "%MW8023.2";
String PC_SL_TBGAS_ATLAS_SMARTS1VELFL           = "%MW8023.3";
String PC_SL_TBGAS_ATLAS_SMARTS2VELFL           = "%MW8023.4";
String PC_SL_TBGAS_ATLAS_COMBOS1VELFL           = "%MW8023.5";
String PC_SL_TBGAS_ATLAS_COMBOS2VELFL           = "%MW8023.6";
String PC_SL_TBGAS_ATLAS_CANAL1DO44FL           = "%MW8023.7";
String PC_SL_TBGAS_ATLAS_CANAL2DO44FL           = "%MW8023.8";
String PC_SL_TBGAS_ATLAS_CANAL1DO25FL           = "%MW8023.9";
String PC_SL_TBGAS_ATLAS_CANAL2DO25FL           = "%MW8023.10";
String PC_SL_TBGAS_ATLAS_CANAL1DO32FL           = "%MW8023.11";
String PC_SL_TBGAS_ATLAS_CANAL2DO32FL           = "%MW8023.12";
String PC_SL_TBGAS_ATLAS_CANAL3DO32FL           = "%MW8023.13";
String PC_SL_TBGAS_ATLAS_CANAL4DO32FL           = "%MW8023.14";
String PC_SL_TBGAS_ATLAS_RACKFL                 = "%MW8023.15";
String PC_SL_TBGAS_ATLAS_LINKCOMADAM3FL         = "%MW8024.0";
String PC_SL_TBGAS_ATLAS_PROTCOMADAM3FL         = "%MW8024.1";
String PC_SL_TBGAS_ATLAS_LINKCOMADAM4FL         = "%MW8024.2";
String PC_SL_TBGAS_ATLAS_PROTCOMADAM4FL         = "%MW8024.3";
String PC_SL_TBGAS_ATLAS_LINKCOMADAM5FL         = "%MW8024.4";
String PC_SL_TBGAS_ATLAS_PROTCOMADAM5FL         = "%MW8024.5";
String PC_SL_TBGAS_ATLAS_LINKCOMADAM6FL         = "%MW8024.6";
String PC_SL_TBGAS_ATLAS_PROTCOMADAM6FL         = "%MW8024.7";
String PC_SL_TBGAS_ATLAS_LINKCOMADAM7FL         = "%MW8024.8";
String PC_SL_TBGAS_ATLAS_PROTCOMADAM7FL         = "%MW8024.9";
String PC_SL_TBGAS_ATLAS_FONTEPS1FL             = "%MW8024.10";
String PC_SL_TBGAS_ATLAS_FONTEPS2FL             = "%MW8024.11";
String PC_SL_TBGAS_ATLAS_FONTEPS3FL             = "%MW8024.12";
String PC_SL_TBGAS_ATLAS_FONTEPS4FL             = "%MW8024.13";
String PC_SL_TBGAS_ATLAS_MLPRDEMERGFL           = "%MW8024.14";
String PC_SL_TBGAS_ATLAS_MLINBDISPHALFL         = "%MW8024.15";
String PC_SL_TBGAS_ATLAS_MLSISINCFL             = "%MW8025.0";
String PC_SL_TBGAS_ATLAS_SDANTORQUEFL           = "%MW8025.1";
String PC_SL_TBGAS_ATLAS_SDANNPTPSCMFL          = "%MW8025.2";
String PC_SL_TBGAS_ATLAS_SDANNGGPSCMFL          = "%MW8025.3";
String PC_SL_TBGAS_ATLAS_SDANPLAPSCMFL          = "%MW8025.4";
String PC_SL_TBGAS_ATLAS_QQTRIP                 = "%MW8025.5";
String PC_SL_TBGAS_ATLAS_POLSENSFLTRIP          = "%MW8025.6";
String PC_SL_TBGAS_ATLAS_OLPBXTRIP              = "%MW8025.7";
String PC_SL_TBGAS_ATLAS_PS3SENSFLTRIP          = "%MW8025.8";
String PC_SL_TBGAS_ATLAS_STALLGGTRIP            = "%MW8025.9";
String PC_SL_TBGAS_ATLAS_NGGALTRIP              = "%MW8025.10";
String PC_SL_TBGAS_ATLAS_NGGSENSFLTRIP          = "%MW8025.11";
String PC_SL_TBGAS_ATLAS_NTPALTRIP              = "%MW8025.12";
String PC_SL_TBGAS_ATLAS_NTPSENSFLTRIP          = "%MW8025.13";
String PC_SL_TBGAS_ATLAS_T54ALTRIP              = "%MW8025.14";
String PC_SL_TBGAS_ATLAS_CORFSOV1ALTRIP         = "%MW8025.15";
String PC_SL_TBGAS_ATLAS_CORFSOV1BXTRIP         = "%MW8026.0";
String PC_SL_TBGAS_ATLAS_CORFSOV2ALTRIP         = "%MW8026.1";
String PC_SL_TBGAS_ATLAS_CORFSOV2BXTRIP         = "%MW8026.2";
String PC_SL_TBGAS_ATLAS_T54FLTRIP              = "%MW8026.3";
String PC_SL_TBGAS_ATLAS_CORFPVALTRIP           = "%MW8026.4";
String PC_SL_TBGAS_ATLAS_CORFPVBXTRIP           = "%MW8026.5";
String PC_SL_TBGAS_ATLAS_VIBSENSGGTRIP          = "%MW8026.6";
String PC_SL_TBGAS_ATLAS_VIBSENSTPTRIP          = "%MW8026.7";
String PC_SL_TBGAS_ATLAS_NGG1200FLTRIP          = "%MW8026.8";
String PC_SL_TBGAS_ATLAS_NGG4500FLTRIP          = "%MW8026.9";
String PC_SL_TBGAS_ATLAS_TGAPAGADATRIP          = "%MW8026.10";
String PC_SL_TBGAS_ATLAS_PRDEMLOCHWTRIP         = "%MW8026.11";
String PC_SL_TBGAS_ATLAS_PRDEMREMHWTRIP         = "%MW8026.12";
String PC_SL_TBGAS_ATLAS_PRDINLOCHWTRIP         = "%MW8026.13";
String PC_SL_TBGAS_ATLAS_PRDINREMHWTRIP         = "%MW8026.14";
String PC_SL_TBGAS_ATLAS_VEXTODNABRTRIP         = "%MW8026.15";
String PC_SL_TBGAS_ATLAS_VEXTODNFECTRIP         = "%MW8027.0";
String PC_SL_TBGAS_ATLAS_ASOVNABRTRIP           = "%MW8027.1";
String PC_SL_TBGAS_ATLAS_ASOVNFECHTRIP          = "%MW8027.2";
String PC_SL_TBGAS_ATLAS_INCENDIOTGTRIP         = "%MW8027.3";
String PC_SL_TBGAS_ATLAS_ODEXTPALTRIP           = "%MW8027.4";
String PC_SL_TBGAS_ATLAS_MANIFPALTRIP           = "%MW8027.5";
String PC_SL_TBGAS_ATLAS_OLRETATALTRIP          = "%MW8027.6";
String PC_SL_TBGAS_ATLAS_OLRETBTALTRIP          = "%MW8027.7";
String PC_SL_TBGAS_ATLAS_OLRETCTALTRIP          = "%MW8027.8";
String PC_SL_TBGAS_ATLAS_OLRETDTALTRIP          = "%MW8027.9";
String PC_SL_TBGAS_ATLAS_OLRETETALTRIP          = "%MW8027.10";
String PC_SL_TBGAS_ATLAS_NGGALHDWTRIP           = "%MW8027.11";
String PC_SL_TBGAS_ATLAS_NTPALHDWTRIP           = "%MW8027.12";
String PC_SL_TBGAS_ATLAS_TORQUETRIP             = "%MW8027.13";
String PC_SL_TBGAS_ATLAS_VIBGGDIRTRIP           = "%MW8027.14";
String PC_SL_TBGAS_ATLAS_VIBGGNOGGTRIP          = "%MW8027.15";
String PC_SL_TBGAS_ATLAS_VIBTPNOGGTRIP          = "%MW8028.0";
String PC_SL_TBGAS_ATLAS_VIBTPDIRTRIP           = "%MW8028.1";
String PC_SL_TBGAS_ATLAS_VIBTPNOTPTRIP          = "%MW8028.2";
String PC_SL_TBGAS_ATLAS_VIBGGNOTPTRIP          = "%MW8028.3";
String PC_SL_TBGAS_ATLAS_PRDEMHMITRIP           = "%MW8028.4";
String PC_SL_TBGAS_ATLAS_PRDINCHMITRIP          = "%MW8028.5";
String PC_SL_TBGAS_ATLAS_LGVIBSENGGTRIP         = "%MW8028.6";
String PC_SL_TBGAS_ATLAS_LGVIBSENTPTRIP         = "%MW8028.7";
String PC_SL_TBGAS_ATLAS_OUTSFORCTRIP           = "%MW8028.8";
String PC_SL_TBGAS_ATLAS_PTDMANIFALTRIP         = "%MW8028.9";
String PC_SL_TBGAS_ATLAS_PTDT54ALTRIP           = "%MW8028.10";
String PC_SL_TBGAS_ATLAS_T54BXTRIP              = "%MW8028.11";
String PC_SL_TBGAS_ATLAS_PRDEMSCMTRIP           = "%MW8028.12";
String PC_SL_TBGAS_ATLAS_PRDINCSCMTRIP          = "%MW8028.13";
String PC_SL_TBGAS_ATLAS_PTDAUXFLTRIP           = "%MW8028.14";
String PC_SL_TBGAS_ATLAS_VEXTODABTOPER          = "%MW8028.15";
String PC_SL_TBGAS_ATLAS_NOVOALNREC             = "%MW8029.0";
String PC_SL_TBGAS_ATLAS_QQALARME               = "%MW8029.1";
String PC_SL_TBGAS_ATLAS_SILENCAL               = "%MW8029.2";
String PC_SL_TBGAS_ATLAS_RECTODOSAL             = "%MW8029.3";
String PC_SL_TBGAS_ATLAS_QQBO                   = "%MW8029.4";
String PC_SL_TBGAS_ATLAS_CAMCRITK19             = "%MW8029.5";
String PC_SL_TBGAS_ATLAS_ALPRDAQUENTE           = "%MW8029.6";
String PC_SL_TBGAS_ATLAS_DISPHALINBREDE         = "%MW8029.7";
String PC_SL_TBGAS_ATLAS_SOBRETEMPINVOL         = "%MW8029.8";
String PC_SL_TBGAS_ATLAS_GGCV1FL                = "%MW8029.9";
String PC_SL_TBGAS_ATLAS_TPCV2FL                = "%MW8029.10";
String PC_SA_TBGAS_ATLAS_CONTANO                = "%MF8032";
String PC_SA_TBGAS_ATLAS_CONTMES                = "%MF8034";
String PC_SA_TBGAS_ATLAS_CONTDIA                = "%MF8036";
String PC_SA_TBGAS_ATLAS_CONTDIASEM             = "%MF8038";
String PC_SA_TBGAS_ATLAS_CONTHORA               = "%MF8040";
String PC_SA_TBGAS_ATLAS_CONTMIN                = "%MF8042";
String PC_SA_TBGAS_ATLAS_CONTSEG                = "%MF8044";
String PC_SA_TBGAS_ATLAS_CORRENTEFSOV1          = "%MF8046";
String PC_SA_TBGAS_ATLAS_CORRENTEFSOV2          = "%MF8048";
String PC_SA_TBGAS_ATLAS_CORRENTEFPV            = "%MF8050";
String PC_SA_TBGAS_ATLAS_RESERVA001             = "%MF8052";
String PC_SA_TBGAS_ATLAS_TANQUEOLNIVEL          = "%MF8054";
String PC_SA_TBGAS_ATLAS_ARSAIDAINVTEMP         = "%MF8056";
String PC_SA_TBGAS_ATLAS_FILTBBAODPDIF          = "%MF8058";
String PC_SA_TBGAS_ATLAS_FILTOLSUPPDIF          = "%MF8060";
String PC_SA_TBGAS_ATLAS_FILTOLRETPDIF          = "%MF8062";
String PC_SA_TBGAS_ATLAS_TEMPODISPCO2           = "%MF8064";
String PC_SA_TBGAS_ATLAS_ODENTPRESS             = "%MF8066";
String PC_SA_TBGAS_ATLAS_ODINVOLTEMP            = "%MF8068";
String PC_SA_TBGAS_ATLAS_ODMANIFPRESS           = "%MF8070";
String PC_SA_TBGAS_ATLAS_OLPRESS                = "%MF8072";
String PC_SA_TBGAS_ATLAS_OLRETATEMP             = "%MF8074";
String PC_SA_TBGAS_ATLAS_OLRETBTEMP             = "%MF8076";
String PC_SA_TBGAS_ATLAS_OLRETCTEMP             = "%MF8078";
String PC_SA_TBGAS_ATLAS_OLRETDTEMP             = "%MF8080";
String PC_SA_TBGAS_ATLAS_OLRETETEMP             = "%MF8082";
String PC_SA_TBGAS_ATLAS_OLSAITROCTEMP          = "%MF8084";
String PC_SA_TBGAS_ATLAS_LIMITETORQUE           = "%MF8086";
String PC_SA_TBGAS_ATLAS_LSSPLADEMANDA          = "%MF8088";
String PC_SA_TBGAS_ATLAS_NTPDEMANDA             = "%MF8090";
String PC_SA_TBGAS_ATLAS_PLALOCDEMANDA          = "%MF8092";
String PC_SA_TBGAS_ATLAS_FDBKLIMPLAHMI          = "%MF8094";
String PC_SA_TBGAS_ATLAS_FDBKLIMPLASCM          = "%MF8096";
String PC_SA_TBGAS_ATLAS_FDBKSPNPTHMI           = "%MF8098";
String PC_SA_TBGAS_ATLAS_FDBKSPNPTSCM           = "%MF8100";
String PC_SA_TBGAS_ATLAS_FDBKSPPLAHMI           = "%MF8102";
String PC_SA_TBGAS_ATLAS_FDBKSPPLASCM           = "%MF8104";
String PC_SA_TBGAS_ATLAS_NUMPTDAS               = "%MF8106";
String PC_SA_TBGAS_ATLAS_HORASOPER              = "%MF8108";
String PC_SA_TBGAS_ATLAS_TPTORQUE               = "%MF8110";
String PC_SA_TBGAS_ATLAS_TPPOTENCIA             = "%MF8112";
String PC_SA_TBGAS_ATLAS_NTPCORREGT2            = "%MF8114";
String PC_SA_TBGAS_ATLAS_NGG                    = "%MF8116";
String PC_SA_TBGAS_ATLAS_NGGCORREGT2            = "%MF8118";
String PC_SA_TBGAS_ATLAS_NTP                    = "%MF8120";
String PC_SA_TBGAS_ATLAS_PDIFARCOMB             = "%MF8122";
String PC_SA_TBGAS_ATLAS_PS3                    = "%MF8124";
String PC_SA_TBGAS_ATLAS_VARIAPS3               = "%MF8126";
String PC_SA_TBGAS_ATLAS_PT2                    = "%MF8128";
String PC_SA_TBGAS_ATLAS_PT54                   = "%MF8130";
String PC_SA_TBGAS_ATLAS_T54                    = "%MF8132";
String PC_SA_TBGAS_ATLAS_SEGNGG1200rpm          = "%MF8134";
String PC_SA_TBGAS_ATLAS_SEGDLGSTARTER          = "%MF8136";
String PC_SA_TBGAS_ATLAS_SEGFLACEND             = "%MF8138";
String PC_SA_TBGAS_ATLAS_SEGFIMAQCIDLE          = "%MF8140";
String PC_SA_TBGAS_ATLAS_SEGFIMRESFIDLE         = "%MF8142";
String PC_SA_TBGAS_ATLAS_SEGHAbarRANQUE         = "%MF8144";
String PC_SA_TBGAS_ATLAS_SEGLIBPTDTG            = "%MF8146";
String PC_SA_TBGAS_ATLAS_SEGFIMPURGA            = "%MF8148";
String PC_SA_TBGAS_ATLAS_T2                     = "%MF8150";
String PC_SA_TBGAS_ATLAS_LIMITET54              = "%MF8152";
String PC_SA_TBGAS_ATLAS_NPTBENTLY              = "%MF8154";
String PC_SA_TBGAS_ATLAS_VIBTPNOGG              = "%MF8156";
String PC_SA_TBGAS_ATLAS_VIBGGNOGG              = "%MF8158";
String PC_SA_TBGAS_ATLAS_VIBTPDIRETA            = "%MF8160";
String PC_SA_TBGAS_ATLAS_VIBTPNOTP              = "%MF8162";
String PC_SA_TBGAS_ATLAS_VIBGGNOTP              = "%MF8164";
String PC_SA_TBGAS_ATLAS_VIBGGTOTSPAL           = "%MF8166";
String PC_SA_TBGAS_ATLAS_VIBGGTOTSPDLG          = "%MF8168";
String PC_SA_TBGAS_ATLAS_VIBTPNOGGSPAL          = "%MF8170";
String PC_SA_TBGAS_ATLAS_VIBTPNGGSPTDLG         = "%MF8172";
String PC_SA_TBGAS_ATLAS_VIBTPTOTSPAL           = "%MF8174";
String PC_SA_TBGAS_ATLAS_VIBGGNOTPSPAL          = "%MF8176";
String PC_SA_TBGAS_ATLAS_VIBGGNOTPSPDLG         = "%MF8178";
String PC_SA_TBGAS_ATLAS_VIBGGNOGGSPAL          = "%MF8180";
String PC_SA_TBGAS_ATLAS_VIBGGNOGGSPDLG         = "%MF8182";
String PC_SA_TBGAS_ATLAS_VIBTPNOTPSPAL          = "%MF8184";
String PC_SA_TBGAS_ATLAS_VIBTPNOTPSPDLG         = "%MF8186";
String PC_SA_TBGAS_ATLAS_PRIMALDISP             = "%MF8188";
String PC_SA_TBGAS_ATLAS_PRIMALHDWDISP          = "%MF8190";
String PC_SA_TBGAS_ATLAS_PRIMTRIPDISP           = "%MF8192";
String PC_SA_TBGAS_ATLAS_ESTADOATIVO            = "%MF8194";
String PC_SA_TBGAS_ATLAS_VIBTPTOTSPSD           = "%MF8196";
String PC_SA_TBGAS_ATLAS_LIMITPLARAMPA          = "%MF8198";
String PC_SA_TBGAS_ATLAS_SPN2RAMPA              = "%MF8200";
String PC_SA_TBGAS_ATLAS_SPPLARAMPA             = "%MF8202";
String PC_SA_TBGAS_ATLAS_PLA                    = "%MF8204";
String PC_SA_TBGAS_ATLAS_OLRETPRESS             = "%MF8206";
String PC_SA_TBGAS_ATLAS_TPMAQQUENTE            = "%MF8208";
String PC_SA_TBGAS_ATLAS_REGTORQDEMANDA         = "%MF8210";
String PC_SA_TBGAS_ATLAS_REGT54DEMANDA          = "%MF8212";
String PC_SA_TBGAS_ATLAS_REGNTPDEMANDA          = "%MF8214";
String PC_SA_TBGAS_ATLAS_PLACMDO                = "%MF8216";
String PC_SA_TBGAS_ATLAS_ODEXTTEMP              = "%MF8218";
String PC_SA_TBGAS_ATLAS_RESERVA002             = "%MF8220";
String PC_SA_TBGAS_ATLAS_TPSTARTERLIGHC         = "%MF8222";
String PC_SA_TBGAS_ATLAS_TPSTARTERLIGLC         = "%MF8224";
String PC_SA_TBGAS_ATLAS_TPREPTDAQT             = "%MF8226";
String PC_SA_TBGAS_ATLAS_TPATIVAUX              = "%MF8228";
String PC_SA_TBGAS_ATLAS_TPLOCKOUTIGN           = "%MF8230";
String PC_SA_TBGAS_ATLAS_PLALIMINTERNO          = "%MF8232";
String PC_SA_TBGAS_ATLAS_PLAEMGRAUS             = "%MF8234";
String PC_SA_TBGAS_ATLAS_PLAVELOC               = "%MF8236";
//--------------------------- MCTG ---------------------------
String PC_HL_TBGAS_MCTG_STALLGGACIM7500         = "%MW6194.0";
String PC_HL_TBGAS_MCTG_INCENDIOTG              = "%MW6194.1";
String PC_HL_TBGAS_MCTG_NAOPARADA               = "%MW6194.2";
String PC_HL_TBGAS_MCTG_PARANDO                 = "%MW6194.3";
String PC_HL_TBGAS_MCTG_EMOPERACAO              = "%MW6194.4";
String PC_HL_TBGAS_MCTG_PRTNDORAPD              = "%MW6194.5";
String PC_HL_TBGAS_MCTG_PRTNDONORM              = "%MW6194.6";
String PC_HL_TBGAS_MCTG_STALLGGHDOWN            = "%MW6194.7";
String PC_HL_TBGAS_MCTG_SDANTORQUEFL            = "%MW6194.8";
String PC_HL_TBGAS_MCTG_SDANNPTPSCMFL           = "%MW6194.9";
String PC_HL_TBGAS_MCTG_AMBNPTPSCMFL            = "%MW6194.10";
String PC_HL_TBGAS_MCTG_CALCTORQUEFL            = "%MW6194.11";
String PC_HL_TBGAS_MCTG_QQALARME                = "%MW6194.12";
String PC_HL_TBGAS_MCTG_QQTRIP                  = "%MW6194.13";
String PC_HL_TBGAS_MCTG_PRDEMERG                = "%MW6194.14";
String PC_HL_TBGAS_MCTG_PRDINC                  = "%MW6194.15";
String PC_HL_TBGAS_MCTG_QQTRIPBO                = "%MW6195.0";
String PC_HL_TBGAS_MCTG_NGGSENSORFL             = "%MW6195.1";
String PC_HL_TBGAS_MCTG_PLAFL                   = "%MW6195.2";
String PC_HL_TBGAS_MCTG_SDANNGGPSCMFL           = "%MW6195.3";
String PC_HL_TBGAS_MCTG_SDANPLAPSCMFL           = "%MW6195.4";
String PC_HL_TBGAS_MCTG_MLPRDEMERGFL            = "%MW6195.5";
String PC_HL_TBGAS_MCTG_MLSISINCFL              = "%MW6195.6";
String PC_HL_TBGAS_MCTG_EMREMOTO                = "%MW6195.7";
String PC_HL_TBGAS_MCTG_EMLOCAL                 = "%MW6195.8";
String PC_HL_TBGAS_MCTG_OVERRIDE1               = "%MW6195.9";
String PC_HL_TBGAS_MCTG_OVERRIDE2               = "%MW6195.10";
String PC_HL_TBGAS_MCTG_QQALARMENREC            = "%MW6195.11";
String PC_HL_TBGAS_MCTG_PRTNDACESA              = "%MW6195.12";
String PC_HL_TBGAS_MCTG_LIMPLAATUANDO           = "%MW6195.13";
String PC_HA_TBGAS_MCTG_TORQUE                  = "%MF6198";
String PC_HA_TBGAS_MCTG_NTP                     = "%MF6200";
String PC_HA_TBGAS_MCTG_NGG                     = "%MF6202";
String PC_HA_TBGAS_MCTG_PLA                     = "%MF6204";
String CP_HL_TBGAS_MCTG_OPERAR1EIXO             = "%MW556.0";
String CP_HL_TBGAS_MCTG_ATVLIMALTRNV            = "%MW556.1";
String CP_HL_TBGAS_MCTG_ATVPLAMANUAL            = "%MW556.2";

//--------------------------- ETH1 ---------------------------
String CP_SL_TBGAS_ETH1_PARTIR                  = "%MW750.0";
String CP_SL_TBGAS_ETH1_PARAR                   = "%MW750.1";
String CP_SL_TBGAS_ETH1_PARTIRRAPIDO            = "%MW750.2";
String CP_SL_TBGAS_ETH1_PARAREMERG              = "%MW750.3";
String CP_SL_TBGAS_ETH1_PARARINCEND             = "%MW750.4";
String CP_SL_TBGAS_ETH1_ABRIRABV                = "%MW750.5";
String CP_SL_TBGAS_ETH1_FECHARABV               = "%MW750.6";
String CP_SL_TBGAS_ETH1_ABRIRVVEXTOD            = "%MW750.7";
String CP_SL_TBGAS_ETH1_FECHARVVEXTOD           = "%MW750.8";
String CP_SL_TBGAS_ETH1_LIGBTOV1                = "%MW750.9";
String CP_SL_TBGAS_ETH1_LIGOSOV2                = "%MW750.10";
String CP_SL_TBGAS_ETH1_DESLIGBTOV1             = "%MW750.11";
String CP_SL_TBGAS_ETH1_DESLIGOSOV2             = "%MW750.12";
String CP_SL_TBGAS_ETH1_RECTDAL                 = "%MW750.13";
String CP_SL_TBGAS_ETH1_REARME                  = "%MW750.14";
String CP_SL_TBGAS_ETH1_SILENCAL                = "%MW750.15";
String CP_SL_TBGAS_ETH1_INIBDISPHALON           = "%MW751.0";
String CP_SL_TBGAS_ETH1_HABDISPHALON            = "%MW751.1";
String CP_SA_TBGAS_ETH1_SPSCMNTP                = "%MW758";
String CP_SA_TBGAS_ETH1_SPSCMPLA                = "%MW759";
String CP_SA_TBGAS_ETH1_WATCHDOG                = "%MW760";
//--------------------------- ETH2 ---------------------------
String CP_SL_TBGAS_ETH2_PARTIR                  = "%MW800.0";
String CP_SL_TBGAS_ETH2_PARAR                   = "%MW800.1";
String CP_SL_TBGAS_ETH2_PARTIRRAPIDO            = "%MW800.2";
String CP_SL_TBGAS_ETH2_PARAREMERG              = "%MW800.3";
String CP_SL_TBGAS_ETH2_PARARINCEND             = "%MW800.4";
String CP_SL_TBGAS_ETH2_ABRIRABV                = "%MW800.5";
String CP_SL_TBGAS_ETH2_FECHARABV               = "%MW800.6";
String CP_SL_TBGAS_ETH2_ABRIRVVEXTOD            = "%MW800.7";
String CP_SL_TBGAS_ETH2_FECHARVVEXTOD           = "%MW800.8";
String CP_SL_TBGAS_ETH2_LIGBTOV1                = "%MW800.9";
String CP_SL_TBGAS_ETH2_LIGOSOV2                = "%MW800.10";
String CP_SL_TBGAS_ETH2_DESLIGBTOV1             = "%MW800.11";
String CP_SL_TBGAS_ETH2_DESLIGOSOV2             = "%MW800.12";
String CP_SL_TBGAS_ETH2_RECTDAL                 = "%MW800.13";
String CP_SL_TBGAS_ETH2_REARME                  = "%MW800.14";
String CP_SL_TBGAS_ETH2_SILENCAL                = "%MW800.15";
String CP_SL_TBGAS_ETH2_INIBDISPHALON           = "%MW801.0";
String CP_SL_TBGAS_ETH2_HABDISPHALON            = "%MW801.1";
String CP_SA_TBGAS_ETH2_SPSCMNTP                = "%MW808";
String CP_SA_TBGAS_ETH2_SPSCMPLA                = "%MW809";
String CP_SA_TBGAS_ETH2_WATCHDOG                = "%MW810";
//
String PC_HL_AOLTG_TQDREN_NIVELALTO             = "%MW6016.8";

//------------------- VARIAVEIS DOS INTERNAS -------------------
String                   IP = "120.40.0.1";
String     CONTADOR_CONEXAO = "%MW33000";
String             NomeForm = "TG";
bool           perdaconexao = false;
int               Varredura = 0;
float          VALOR_ANTIGO = 0;
bool            contador_ok = false;
int           contador_scan = 0;
int            numeroquedas = 0;
int                   MWO_i = 5000;
int                   MWO_f = 5038;
int               MWO_i_HDW = 3146;
int               MWO_f_HDW = 3150;
int                contador = 0;
int                  lista  = 0;
bool      ack_partir_normal = false;
bool      ack_partir_rapido = false;
bool       ack_parar_normal = false;
bool   ack_parar_emergencia = false;
bool     ack_parar_incendio = false;
int        contador_partida = 0;
bool         partida_rapida = false;
bool         partida_normal = false;
int         contador_parada = 0;
bool    resfriando_tg_acesa = false;
bool         inibir_partida = false;
bool          inibir_parada = false;
bool                  crank = false;
bool         crank_liberado = false;
bool ack_parar_lig_batover1 = false;
bool ack_parar_lig_batover2 = false;
bool               em_local = false;
int                  sp_ntp = 0;
float                sp_pla = 0;
int               ntp_atual = 0;
float             pla_atual = 0;
bool            em_operacao = false;
int         valor_p_ratemax = 100;
int                rate_max = 300;
int              rate_aprox = 20;
bool                ModoNTP = true;
bool                ModoPLA = false;
float               pla_min = 0;
float               pla_max = 100;
float          rate_max_pla = 1;
float        rate_aprox_pla = 0.1;
float               ntp_min = 1100;
float               ntp_max = 3960;
float          ntp_etapa_00 = 200;  // lowcrank
float          ntp_etapa_01 = 300;  // highcrank/partir
float          ntp_etapa_02 = 500;  // partir
float          ntp_etapa_03 = 1050; // parar
float          rotacao_calc = 0;
float              pla_calc = 0;
float            multip_ngg = 5.263;
int               ngg_atual = 0;
float               ngg_min = 5000;
float               ngg_max = 9800;
bool        em_parada_emerg = false;
bool       silenciar_sirene = true;
bool       ack_abrir_vod116 = false;
bool      ack_fechar_vod116 = false;
bool             variar_ntp = false;
float     taxa_variacao_ntp = 20;
int       contador_variacao = 0;
bool           estabilizado = false;
bool            varicao_ntp = false;
bool         ack_ativar_pla = false;

//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TfrmPrincipal *frmPrincipal;

//CONFIGURAÇÃO DO DRIVER
TModBusTCPDriver CLP ( frmPrincipal,IP,QUANTUM );

//---------------------------------------------------------------------------
__fastcall TfrmPrincipal::TfrmPrincipal(TComponent* Owner)
        : TForm(Owner)
{
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::FormCreate(TObject *Sender)
{
        AnsiString TimeStamp;
//ABERTURA DA CONEXÃO COM CLP
        CLP.Open(IP);
//CARREGA AUDIO DO ALARME
        mplAudio->FileName = ExtractFilePath(Application->ExeName) + "\\Red Alert.wav";
        mplAudio->Open();
//INÍCIO DA INICIALIZAÇÃO
        frmPrincipal->Caption = NomeForm + " - Carregando";
        frmPrincipal->Top = 0;
        frmPrincipal->Left = 0;
        frmPrincipal->Height = 600;
        frmPrincipal->Width = 800;

        pnlStatus->Visible = true;
        pnlLocal->Visible = false;
        pnlFunc->Visible = false;
        pnlComandos->Visible = false;

        DateTimeToString( TimeStamp, AnsiString( "hh:nn:ss" ), Now() );

        lblInicioPrograma->Caption = TimeStamp;
        lblInicioPrograma->Visible = true;
        lblEndereco->Caption = CONTADOR_CONEXAO;
        lblEndereco->Visible = true;
        lblWatchdogEx->Visible = true;

        tmrStarting->Enabled = true;
}
//---------------------------------------------------------------------------
void __fastcall TfrmPrincipal::ConexaoWatchTimer(TObject *Sender)
{
//TIMER DE VERIFICAÇÃO DE CONEXÃO
        lblProgramaAtual->Visible = true;
        lblTamListaIDs->Visible = true;
        lblQuedas->Visible = true;
        lblWatchdog->Visible = true;

        if ( VALOR_ANTIGO != CLP.RD( CONTADOR_CONEXAO ) ){
                //contador_ok = true;
                contador_scan = 0;
        }
        else{
                //contador_ok = false;
                if ( contador_scan <= 3 ){
                        contador_scan++;
                }
        }

         if ( contador_scan <= 3 ){
                contador_ok = true;
        }
        else{
                contador_ok = false;
        }

        lblTamListaIDs->Caption = "ID Usados: " + String (CLP._thread->listaIDsUsados.size());

        if (CLP.Conectado() == 0 ){ //|| contador_ok == false){
               perdaconexao = true;
               numeroquedas++;
               CLP.Close();
               //lblConexao->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Inativa";
               frmPrincipal->Caption = NomeForm + " - Pronto - Leitura Inativa";
               tmrLeitura->Enabled = false;
               if (tmrReconecta->Enabled == false){
                       tmrReconecta->Enabled = true;
               }
        }
        if (CLP.Conectado() != 0 && perdaconexao == true ){//&& contador_ok == true){
               perdaconexao = false;
               tmrLeitura->Enabled = true;
               //tmrStarting->Enabled = true;
        }

        if (CLP.Conectado() != 0 && perdaconexao == false ){//&& contador_ok == true){
                switch(Varredura){
                        case 0:
                                //lblConexao->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa \\";
                                frmPrincipal->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa \\";
                                break;
                        case 1:
                                //lblConexao->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa /";
                                frmPrincipal->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa /";
                                break;
                        case 2:
                                //lblConexao->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa \\";
                                frmPrincipal->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa \\";
                                break;
                        case 3:
                                //lblConexao->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa /";
                                frmPrincipal->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa /";
                                break;
                        case 4:
                                //lblConexao->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa \\";
                                frmPrincipal->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa \\";
                                break;
                        case 5:
                                //lblConexao->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa /";
                                frmPrincipal->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa /";
                                break;
                        case 6:
                                //lblConexao->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa \\";
                                frmPrincipal->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa \\";
                                break;
                        case 7:
                                //lblConexao->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa /";
                                frmPrincipal->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa /";
                                break;
                        case 8:
                                //lblConexao->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa \\";
                                frmPrincipal->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa \\";
                                break;
                        case 9:
                                //lblConexao->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa /";
                                frmPrincipal->Caption = NomeForm + " - Pronto (" + IP + ") - Leitura Ativa /";
                                Varredura = -1;
                                break;
               }
               Varredura++;
        }
//        lblLista->Caption = CLP._listaCmdSimples.size();
//        lblLista->Caption = CLP.TamBufWR();
//        lblLista->Caption = CLP._thread->buffersRecebidos.size();
//        lblConexao->Refresh();

        AnsiString TimeStamp;

        DateTimeToString( TimeStamp, AnsiString( "hh:nn:ss" ), Now() );

        lblProgramaAtual->Caption = TimeStamp;

        lblQuedas->Caption = "Fall: " + String (numeroquedas);

        VALOR_ANTIGO = CLP.RD( CONTADOR_CONEXAO );
        lblWatchdog->Caption = VALOR_ANTIGO;        
}
//---------------------------------------------------------------------------
void __fastcall TfrmPrincipal::tmrStartingTimer(TObject *Sender)
{
//--------------------- INICIA ANALÓGICAS ---------------------
        /* CLP.WR( VARIAVEL ANALOGICA , 0);                      */
        /* prbVARIAVEL ANALOGICA->Max =  100 * 1000; //SE HOUVER */
        /* prbVARIAVEL ANALOGICA->Min = -100 * 1000; //SE HOUVER */
        CLP.WR(PC_SA_TBGAS_ATLAS_ODENTPRESS    , 0.1);

//-------------------------------------------------------------
//---------------------  INICIA DIGITAIS  ---------------------
        /*CLP.WR( VARIAVEL_DIGITAL, 0 OU 1 );*/
        CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 1);
        CLP.WR(PC_SL_TBGAS_ATLAS_ATIVANDOAUXIL , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_ACELPRAQUEIMA , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_APLICANDOOD   , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_ACELPRARALANTI, 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_AQCTGEMRALANTI, 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_EMOPERACAO    , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_RESFEMRALANTI , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_EMCOASTDOWN   , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PARADA        , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_OKPARACRANK   , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_TGVIRANDO     , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_EMMOTORIZRAP  , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_DESACELQUEIMA , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_FORADESERVICO , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PURGPOSFLACEND, 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PURGAMOTLENTA , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_EMLOCAL        , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_EMREMOTO      , 1);
        CLP.WR(PC_HL_TBGAS_MCTG_EMREMOTO       , 1);
        CLP.WR(PC_SL_TBGAS_ATLAS_PTDRAPSEL     , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PTDNORMSEL    , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_NAOPARADA      , 0);
	CLP.WR(PC_HL_TBGAS_MCTG_PARANDO        , 0);
	CLP.WR(PC_HL_TBGAS_MCTG_PRTNDACESA     , 0);
	CLP.WR(PC_HL_TBGAS_MCTG_EMOPERACAO     , 0);
	CLP.WR(PC_HL_TBGAS_MCTG_PRTNDORAPD     , 0);
	CLP.WR(PC_HL_TBGAS_MCTG_PRTNDONORM     , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_MOTORIZAPSEL  , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_MOTORIZBPSEL  , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE1LOC  , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE1REM  , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE1ATIV , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_OVERRIDE1      , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE2LOC  , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE2REM  , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE2ATIV , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_OVERRIDE2      , 0);
        CLP.WR(PC_SA_TBGAS_ATLAS_NTP           , 0);
        CLP.WR(PC_HA_TBGAS_MCTG_NTP            , 0);
        CLP.WR(PC_SA_TBGAS_ATLAS_PLA           , 0);
        CLP.WR(PC_HA_TBGAS_MCTG_PLA            , 0);
        CLP.WR(PC_SA_TBGAS_ATLAS_NGG           , 0);
        CLP.WR(PC_HA_TBGAS_MCTG_NGG            , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PLAEMMAN      , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_QUALQUERALARME, 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_QQTRIP        , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PRDEMSCMTRIP  , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PRDEMLOCHWTRIP, 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_QQALARME      , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_QQALARME       , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_QQTRIP         , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_PRDEMERG       , 0);
        //PERMISSIVOS DE PARTIDA DA TG
        CLP.WR(PC_HL_AOLTG_TQDREN_NIVELALTO    , 1);//(NÍVEL BAIXO TQ DRENOS MANFOLD)
        CLP.WR(PC_SL_TBGAS_ATLAS_PERMPTDATLASOK, 1);// BLQ MANUAL PTDA NÃO ATIVADO (CHAVE NO CCM)
        CLP.WR(PC_SL_TBGAS_ATLAS_PERMPTDOLNVOK , 1);// NÍVEL OL TQ MOD. LUB. NORMAL
        CLP.WR(PC_SL_TBGAS_ATLAS_PERMPTDLUBOK  , 1);// (TEMPERATURAS OL NORMAIS ( POCETOS E MOD. LUBRIF.)
        CLP.WR(PC_SL_TBGAS_ATLAS_ABVFEC        , 1);// (VV SANGRIA AR FECHADA)
        CLP.WR(PC_SL_TBGAS_ATLAS_ABVABT        , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PERMPTDODPOK  , 1);// PRESSÃO SUPRIMENTO COMBUSTÍVEL OK (0.34 A 0.45 BAR)
        CLP.WR(PC_SL_TBGAS_ATLAS_PERMPTDODTOK  , 1);// TEMP SUPRIMENTO COMBUSTÍVEL OK (0°C A 70°C)
        CLP.WR(PC_SL_TBGAS_ATLAS_PLAEMIDLE     , 1);// PLA NO MINIMO
        CLP.WR(PC_SL_TBGAS_ATLAS_LIMPLAATUANDO , 1);// PLA LIMITADO AO MINIMO (CTRL)
        CLP.WR(PC_SL_TBGAS_ATLAS_MINDEMPLA     , 1);
        CLP.WR(PC_SL_TBGAS_ATLAS_PERMPTDIGNOK  , 1);// (IGNIÇÃO SEM FALHAS)
        CLP.WR(PC_SL_TBGAS_ATLAS_PERMPTDNGGBX  , 1);// NGG < 300 RPM
        CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODFECH   , 1);// VV EXT COMB FECHADA (VOD 116)
        CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODABT    , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_ASOVFECH      , 1);
        //CLP.WR(PC_SL_TBGAS_ATLAS_ASOVABT       , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_ARRANQUEOK    , 1);
        CLP.WR(PC_SL_TBGAS_ATLAS_PERMPTDSPNTPBX, 1);
        CLP.WR(PC_SL_TBGAS_ATLAS_DAMPERABT     , 1);
        CLP.WR(PC_SL_TBGAS_ATLAS_FLAPABT       , 1);


//-------------------------------------------------------------
//-------------------------------------------------------------
//ACIONA TODOS OS ENDEREÇOS DE SIMULAÇÃO
        for (int i = MWO_i; i < MWO_f + 1; i++){
                String tempMW = "%MW" ;
                tempMW += i;
                //int teste =  CLP.RD( tempMW );
                //if ( teste != -1){
                        CLP.WR(tempMW, 0xFFFF);
                //}
        }

        CLP.WR("%MW3016.8", 1);

        for (int i = MWO_i_HDW; i < MWO_f_HDW + 1; i++){
                String tempMW = "%MW" ;
                tempMW += i;
                //int teste =  CLP.RD( tempMW );
                //if ( teste != -1){
                        CLP.WR(tempMW, 0xFFFF);
                //}
        }

        frmPrincipal->Caption = NomeForm + " - Pronto (CLP" + IP + ")";
        tmrLeitura->Enabled = true;
        lblBufferR->Visible = true;
        lblBufferW->Visible = true;
        lblBufferEx->Visible = true;
        lblLista->Visible = true;

        if (ConexaoWatch->Enabled == false){
                ConexaoWatch->Enabled = true;
        }
        Lista->Enabled = true;
        tmrDemandaNTP->Enabled = true;

//FIM DA INICIALIZAÇÃO
        tmrStarting->Enabled = false;
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::ListaTimer(TObject *Sender)
{
        lista = CLP.TamBufWR();
        lblLista->Caption = CLP._thread->buffersRecebidos.size();
        lblBufferR->Caption = "RD: " + String (CLP.TamBufRD());
        lblBufferW->Caption = "WR: " + String (CLP.TamBufWR());
        if (lista > 100) {
                //tmrLeitura->Enabled = false;
                //shpAguarde->Top = 440;
                //shpAguarde->Left = 0;
                //shpAguarde->Width = 657;
                //shpAguarde->Height = 49;
                shpAguarde->Visible = true;
                //lblAguarde->Top = 8;
                //lblAguarde->Left = 0;
                //lblAguarde->Width = 649;
                //lblAguarde->Height = 29;
                lblAguarde->Visible = true;
        }
        else{
                //if (lista < 10 ){
                //        tmrLeitura->Enabled = true;
                //}
                //shpAguarde->Top = 5000;
                //shpAguarde->Left = 5000;
                //shpAguarde->Width = 0;
                //shpAguarde->Height = 0;
                shpAguarde->Visible = false;
                //lblAguarde->Top = 5000;
                //lblAguarde->Left = 5000;
                //lblAguarde->Width = 0;
                //lblAguarde->Height = 0;
                lblAguarde->Visible = false;
        }

        /*shpAguarde->Top = 5000;
        shpAguarde->Left = 5000;
        shpAguarde->Width = 0;
        shpAguarde->Height = 0;
        shpAguarde->Visible = false;
        lblAguarde->Top = 5000;
        lblAguarde->Left = 5000;
        lblAguarde->Width = 0;
        lblAguarde->Height = 0;
        lblAguarde->Visible = false;*/        
}
//---------------------------------------------------------------------------
void __fastcall TfrmPrincipal::tmrReconectaTimer(TObject *Sender)
{
//RECONEXÃO
        CLP.Open(IP);
        tmrReconecta->Enabled = false;        
}
//---------------------------------------------------------------------------
void __fastcall TfrmPrincipal::tmrLeituraTimer(TObject *Sender)
{
/* COMANDO PARTIR NORMAL */
        if ( CLP.RD(CP_SL_TBGAS_ETH1_PARTIR) == 1){
                shpPartirNormalETH1->Brush->Color = clLime;
        }else{
                shpPartirNormalETH1->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH2_PARTIR) == 1){
                shpPartirNormalETH2->Brush->Color = clLime;
        }else{
                shpPartirNormalETH2->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH1_PARTIR) == 1 || CLP.RD(CP_SL_TBGAS_ETH2_PARTIR) == 1){
                if ( ack_partir_normal == false && inibir_partida == false){
                        ack_parar_normal = false;
                        tmrParada->Enabled = false;
                        ack_partir_rapido = false;
                        ack_partir_normal = true;
                        partida_rapida = false;
                        partida_normal = true;
                        contador_parada = 0;
                        CLP.WR(PC_SL_TBGAS_ATLAS_PTDRAPSEL , 0);
                        CLP.WR(PC_HL_TBGAS_MCTG_PRTNDORAPD , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_PTDNORMSEL, 1);
                        CLP.WR(PC_HL_TBGAS_MCTG_PRTNDONORM , 1);
                        lblContaParada->Caption = (String) contador_parada + " segundos";
                        if ( tmrPartida->Enabled == false ){
                                tmrPartida->Enabled = true;
                        }
                }
        }
/* COMANDO PARTIR RAPIDO */
        if ( CLP.RD(CP_SL_TBGAS_ETH1_PARTIRRAPIDO) == 1){
                shpPartirRapidoETH1->Brush->Color = clLime;
        }else{
                shpPartirRapidoETH1->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH2_PARTIRRAPIDO) == 1){
                shpPartirRapidoETH2->Brush->Color = clLime;
        }else{
                shpPartirRapidoETH2->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH1_PARTIRRAPIDO) == 1 || CLP.RD(CP_SL_TBGAS_ETH2_PARTIRRAPIDO) == 1){
                if ( ack_partir_rapido == false  && inibir_partida == false){
                        ack_parar_normal = false;
                        tmrParada->Enabled = false;
                        ack_partir_normal = false;
                        ack_partir_rapido = true;
                        partida_normal = false;
                        partida_rapida = true;
                        contador_parada = 0;
                        CLP.WR(PC_SL_TBGAS_ATLAS_PTDNORMSEL, 0);
                        CLP.WR(PC_HL_TBGAS_MCTG_PRTNDONORM , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_PTDRAPSEL , 1);
                        CLP.WR(PC_HL_TBGAS_MCTG_PRTNDORAPD , 1);
                        lblContaParada->Caption = (String) contador_parada + " segundos";
                        if ( tmrPartida->Enabled == false ){
                                tmrPartida->Enabled = true;
                        }
                }
        }
/* COMANDO PARAR NORMAL */
        if ( CLP.RD(CP_SL_TBGAS_ETH1_PARAR) == 1){
                shpPararETH1->Brush->Color = clYellow;
        }else{
                shpPararETH1->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH2_PARAR) == 1){
                shpPararETH2->Brush->Color = clYellow;
        }else{
                shpPararETH2->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH1_PARAR) == 1 || CLP.RD(CP_SL_TBGAS_ETH2_PARAR) == 1){
                if ( ack_parar_normal == false  && inibir_parada == false){
                        ack_partir_normal = false;
                        ack_partir_rapido = false;
                        ack_parar_normal = true;
                        contador_partida = 0;
                        lblContaPartida->Caption = (String) contador_partida + " segundos";
                        tmrPartida->Enabled = false;
                        if (ack_partir_rapido == true || ack_partir_normal == true){
                                ack_partir_rapido = false;
                                ack_partir_normal = false;
                        }
                        tmrParada->Enabled = true;
                }
        }
/*SILENCIAR SIRENE*/
        if ( CLP.RD(CP_SL_TBGAS_ETH1_SILENCAL) == 1){
                shpSilenciarETH1->Brush->Color = clYellow;
        }else{
                shpSilenciarETH1->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH2_SILENCAL) == 1){
                shpSilenciarETH2->Brush->Color = clYellow;
        }else{
                shpSilenciarETH2->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH1_SILENCAL) == 1 || CLP.RD(CP_SL_TBGAS_ETH2_SILENCAL) == 1){
                silenciar_sirene = true;
        }



/* COMANDO PARAR EM EMERGÊNCIA */
        if ( CLP.RD(CP_SL_TBGAS_ETH1_PARAREMERG) == 1){
                shpPararEmergETH1->Brush->Color = clRed;
        }else{
                shpPararEmergETH1->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH2_PARAREMERG) == 1){
                shpPararEmergETH2->Brush->Color = clRed;
        }else{
                shpPararEmergETH2->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_HL_TBGAS_ATLAS_PARAREMERGHDW) == 1){
                shpPararEmergHDW->Brush->Color = clRed;
        }else{
                shpPararEmergHDW->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH1_PARAREMERG) == 1 || CLP.RD(CP_SL_TBGAS_ETH2_PARAREMERG) == 1 || CLP.RD(CP_HL_TBGAS_ATLAS_PARAREMERGHDW) == 1){
                if ( ack_parar_emergencia == false){
                        CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_ATIVANDOAUXIL , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_ACELPRAQUEIMA , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_APLICANDOOD   , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_ACELPRARALANTI, 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_AQCTGEMRALANTI, 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_EMOPERACAO    , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_RESFEMRALANTI , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_PARADA        , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_OKPARACRANK   , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_EMMOTORIZRAP  , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_DESACELQUEIMA , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_PURGPOSFLACEND, 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_PURGAMOTLENTA , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_PTDRAPSEL     , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_PTDNORMSEL    , 0);
                	CLP.WR(PC_HL_TBGAS_MCTG_PRTNDACESA     , 0);
                	CLP.WR(PC_HL_TBGAS_MCTG_EMOPERACAO     , 0);
                	CLP.WR(PC_HL_TBGAS_MCTG_PRTNDORAPD     , 0);
                	CLP.WR(PC_HL_TBGAS_MCTG_PRTNDONORM     , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_MOTORIZAPSEL  , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_MOTORIZBPSEL  , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_TGVIRANDO     , 0);
                        //CLP.WR(PC_HL_TBGAS_MCTG_PARANDO        , 1);
                        //CLP.WR(PC_HL_TBGAS_MCTG_NAOPARADA      , 1);
                        //CLP.WR(PC_SL_TBGAS_ATLAS_EMCOASTDOWN   , 1);
                        CLP.WR(PC_SL_TBGAS_ATLAS_QUALQUERALARME, 1);
                        CLP.WR(PC_SL_TBGAS_ATLAS_QQTRIP        , 1);
                        CLP.WR(PC_SL_TBGAS_ATLAS_PRDEMSCMTRIP  , 1);
                        CLP.WR(PC_SL_TBGAS_ATLAS_QQALARME      , 1);
                        CLP.WR(PC_HL_TBGAS_MCTG_QQALARME       , 1);
                        CLP.WR(PC_HL_TBGAS_MCTG_QQTRIP         , 1);
                        CLP.WR(PC_HL_TBGAS_MCTG_PRDEMERG       , 1);
                        tmrPartida->Enabled = false;
                        if (ack_partir_rapido == true || ack_partir_normal == true){
                                ack_partir_rapido = false;
                                ack_partir_normal = false;
                        }
                        em_operacao = false;
                        em_parada_emerg = true;
                        ack_parar_emergencia = true;
                        contador_parada = 20;
                        tmrParada->Enabled = true;
                }
        }
/* COMANDO PARAR POR INCÊNDIO */
        if ( CLP.RD(CP_SL_TBGAS_ETH1_PARARINCEND) == 1){
                shpPararIncendioETH1->Brush->Color = clRed;
        }else{
                shpPararIncendioETH1->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH2_PARARINCEND) == 1){
                shpPararIncendioETH2->Brush->Color = clRed;
        }else{
                shpPararIncendioETH2->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_HL_TBGAS_ATLAS_PARARINCHDW) == 1){
                shpPararIncendioHDW->Brush->Color = clRed;
        }else{
                shpPararIncendioHDW->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH1_PARARINCEND) == 1 || CLP.RD(CP_SL_TBGAS_ETH2_PARARINCEND) == 1 || CLP.RD(CP_HL_TBGAS_ATLAS_PARARINCHDW) == 1){
                if ( ack_parar_incendio == false){
                        CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_ATIVANDOAUXIL , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_ACELPRAQUEIMA , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_APLICANDOOD   , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_ACELPRARALANTI, 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_AQCTGEMRALANTI, 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_EMOPERACAO    , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_RESFEMRALANTI , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_PARADA        , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_OKPARACRANK   , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_EMMOTORIZRAP  , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_DESACELQUEIMA , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_PURGPOSFLACEND, 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_PURGAMOTLENTA , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_PTDRAPSEL     , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_PTDNORMSEL    , 0);
                	CLP.WR(PC_HL_TBGAS_MCTG_PRTNDACESA     , 0);
                	CLP.WR(PC_HL_TBGAS_MCTG_EMOPERACAO     , 0);
                	CLP.WR(PC_HL_TBGAS_MCTG_PRTNDORAPD     , 0);
                	CLP.WR(PC_HL_TBGAS_MCTG_PRTNDONORM     , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_MOTORIZAPSEL  , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_MOTORIZBPSEL  , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_TGVIRANDO     , 0);
                        //CLP.WR(PC_HL_TBGAS_MCTG_PARANDO        , 1);
                        //CLP.WR(PC_HL_TBGAS_MCTG_NAOPARADA      , 1);
                        //CLP.WR(PC_SL_TBGAS_ATLAS_EMCOASTDOWN   , 1);
                        CLP.WR(PC_SL_TBGAS_ATLAS_QUALQUERALARME, 1);
                        CLP.WR(PC_SL_TBGAS_ATLAS_QQTRIP        , 1);
                        //CLP.WR(PC_SL_TBGAS_ATLAS_PRDEMSCMTRIP  , 1); <- Substituri por Incêndio
                        CLP.WR(PC_SL_TBGAS_ATLAS_QQALARME      , 1);
                        CLP.WR(PC_HL_TBGAS_MCTG_QQALARME       , 1);
                        CLP.WR(PC_HL_TBGAS_MCTG_QQTRIP         , 1);
                        //CLP.WR(PC_HL_TBGAS_MCTG_PRDEMERG       , 1); <- Substituri por Incêndio
                        tmrPartida->Enabled = false;
                        if (ack_partir_rapido == true || ack_partir_normal == true){
                                ack_partir_rapido = false;
                                ack_partir_normal = false;
                        }
                        em_operacao = false;
                        em_parada_emerg = true;
                        ack_parar_incendio = true;
                        contador_parada = 20;
                        tmrParada->Enabled = true;
                }
        }

/* COMANDO LIGAR BAT OVER 1 */
        if ( CLP.RD(CP_SL_TBGAS_ETH1_LIGBTOV1) == 1){
                shpBatOver1ETH1->Brush->Color = clRed;
        }else{
                shpBatOver1ETH1->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH2_LIGBTOV1) == 1){
                shpBatOver1ETH2->Brush->Color = clRed;
        }else{
                shpBatOver1ETH2->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH1_LIGBTOV1) == 1 || CLP.RD(CP_SL_TBGAS_ETH2_LIGBTOV1) == 1 ){
                if ( ack_parar_lig_batover1 == false){
                        ack_parar_lig_batover1 = true;
                        CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE1REM , 1);
                        CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE1ATIV, 1);
                        CLP.WR(PC_HL_TBGAS_MCTG_OVERRIDE1     , 1);
                }
        }

/* COMANDO DESLIGAR BAT OVER 1 */
        if ( CLP.RD(CP_SL_TBGAS_ETH1_DESLIGBTOV1) == 1){
                shpDBatOver1ETH1->Brush->Color = clYellow;
        }else{
                shpDBatOver1ETH1->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH2_DESLIGBTOV1) == 1){
                shpDBatOver1ETH2->Brush->Color = clYellow;
        }else{
                shpDBatOver1ETH2->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH1_DESLIGBTOV1) == 1 || CLP.RD(CP_SL_TBGAS_ETH2_DESLIGBTOV1) == 1 ){
                ack_parar_lig_batover1 = false;
                CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE1REM , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE1ATIV, 0);
                CLP.WR(PC_HL_TBGAS_MCTG_OVERRIDE1     , 0);
        }


/* COMANDO LIGAR BAT OVER 2 */
        if ( CLP.RD(CP_SL_TBGAS_ETH1_LIGOSOV2) == 1){
                shpBatOver2ETH1->Brush->Color = clRed;
        }else{
                shpBatOver2ETH1->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH2_LIGOSOV2) == 1){
                shpBatOver2ETH2->Brush->Color = clRed;
        }else{
                shpBatOver2ETH2->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH1_LIGOSOV2) == 1 || CLP.RD(CP_SL_TBGAS_ETH2_LIGOSOV2) == 1 ){
                if ( ack_parar_lig_batover2 == false){
                        ack_parar_lig_batover2 = true;
                        CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE2REM , 1);
                        CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE2ATIV, 1);
                        CLP.WR(PC_HL_TBGAS_MCTG_OVERRIDE2     , 1);
                }
        }

/* COMANDO DESLIGAR BAT OVER 2 */
        if ( CLP.RD(CP_SL_TBGAS_ETH1_DESLIGOSOV2) == 1){
                shpDBatOver2ETH1->Brush->Color = clYellow;
        }else{
                shpDBatOver2ETH1->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH2_DESLIGOSOV2) == 1){
                shpDBatOver2ETH2->Brush->Color = clYellow;
        }else{
                shpDBatOver2ETH2->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH1_DESLIGOSOV2) == 1 || CLP.RD(CP_SL_TBGAS_ETH2_DESLIGOSOV2) == 1 ){
                ack_parar_lig_batover2 = false;
                CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE2REM , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE2ATIV, 0);
                CLP.WR(PC_HL_TBGAS_MCTG_OVERRIDE2     , 0);
        }

/* Battle Override 1 Ativo */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_OVERRIDE1ATIV) == 1 || CLP.RD(PC_HL_TBGAS_MCTG_OVERRIDE1) == 1 ){
                shpBatOver1Ativo->Brush->Color = clRed;
        }else{
                shpBatOver1Ativo->Brush->Color = clWhite;
        }

/* Battle Override 1 Ativo Em Remoto */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_OVERRIDE1REM) == 1){
                shpBatOver1EmRem->Brush->Color = clRed;
        }else{
                shpBatOver1EmRem->Brush->Color = clWhite;
        }

/* Battle Override 1 Ativo Em Local*/
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_OVERRIDE1LOC) == 1){
                shpBatOver1EmLoc->Brush->Color = clRed;
                shpBatOver1EmLocEx->Pen->Color = clRed;
        }else{
                shpBatOver1EmLoc->Brush->Color = clWhite;
                shpBatOver1EmLocEx->Pen->Color = clBlack;
        }

/* Battle Override 2 Ativo */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_OVERRIDE2ATIV) == 1 || CLP.RD(PC_HL_TBGAS_MCTG_OVERRIDE2) == 1 ){
                shpBatOver2Ativo->Brush->Color = clRed;
        }else{
                shpBatOver2Ativo->Brush->Color = clWhite;
        }

/* Battle Override 2 Ativo Em Remoto */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_OVERRIDE2REM) == 1){
                shpBatOver2EmRem->Brush->Color = clRed;
        }else{
                shpBatOver2EmRem->Brush->Color = clWhite;
        }

/* Battle Override 2 Ativo Em Local*/
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_OVERRIDE2LOC) == 1){
                shpBatOver2EmLoc->Brush->Color = clRed;
                shpBatOver2EmLocEx->Pen->Color = clRed;
        }else{
                shpBatOver2EmLoc->Brush->Color = clWhite;
                shpBatOver2EmLocEx->Pen->Color = clBlack;
        }


/* Pronta para Partir/Crank */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK) == 1){
                shpOKPARTIRCRANK->Brush->Color = clLime;
                crank_liberado = true;
        }else{
                shpOKPARTIRCRANK->Brush->Color = clWhite;
        }

/* Ativando Auxiliares */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_ATIVANDOAUXIL) == 1){
                shpATIVANDOAUXIL->Brush->Color = clLime;
                crank_liberado = false;
        }else{
                shpATIVANDOAUXIL->Brush->Color = clWhite;
        }

/* Ativando Auxiliares */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_ACELPRAQUEIMA) == 1){
                shpACELPRAQUEIMA->Brush->Color = clLime;
                crank_liberado = false;
        }else{
                shpACELPRAQUEIMA->Brush->Color = clWhite;
        }

/* Combustível Ligado */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_APLICANDOOD) == 1){
                shpAPLICANDOOD->Brush->Color = clLime;
                crank_liberado = false;
        }else{
                shpAPLICANDOOD->Brush->Color = clWhite;
        }

/* Acelerando para Ralanti */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_ACELPRARALANTI) == 1){
                shpACELPRARALANTI->Brush->Color = clLime;
                crank_liberado = false;
        }else{
                shpACELPRARALANTI->Brush->Color = clWhite;
        }

/* Aquecendo em Ralanti*/
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_AQCTGEMRALANTI) == 1){
                shpAQCTGEMRALANTI->Brush->Color = clBlue;
                crank_liberado = false;
        }else{
                shpAQCTGEMRALANTI->Brush->Color = clWhite;
        }

/* Em Operação */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_EMOPERACAO) == 1){
                shpEMOPERACAO->Brush->Color = clLime;
                crank_liberado = false;
        }else{
                shpEMOPERACAO->Brush->Color = clWhite;
        }

/* Resfriando em Ralanti */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_RESFEMRALANTI) == 1){
                shpRESFEMRALANTI->Brush->Color = clYellow;
                crank_liberado = false;
        }else{
                shpRESFEMRALANTI->Brush->Color = clWhite;
        }

/* Em Coastdown */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_EMCOASTDOWN) == 1){
                shpEMCOASTDOWN->Brush->Color = clYellow;
                crank_liberado = false;
        }else{
                shpEMCOASTDOWN->Brush->Color = clWhite;
        }

/* Parada */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_PARADA) == 1){
                shpPARADA->Brush->Color = clRed;
                crank_liberado = false;
        }else{
                shpPARADA->Brush->Color = clWhite;
        }

/* OK para Crank */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_OKPARACRANK) == 1){
                shpOKPARACRANK->Brush->Color = clLime;
                crank_liberado = true;
        }else{
                shpOKPARACRANK->Brush->Color = clWhite;
        }

/* Em Remoto */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_EMREMOTO) == 1 || CLP.RD(PC_HL_TBGAS_MCTG_EMREMOTO) == 1 ){
                shpEmRemoto->Brush->Color = clBlue;
                btnEmRemLoc->Caption = "Em Remoto";
                em_local = false;
        }else{
                shpEmRemoto->Brush->Color = clWhite;
        }

/* Em Local */
        if ( CLP.RD(PC_HL_TBGAS_MCTG_EMLOCAL) == 1){
                shpEmLocal->Brush->Color = clRed;
                btnEmRemLoc->Caption = "Em Local";
                em_local = true;
        }else{
                shpEmLocal->Brush->Color = clWhite;
        }

/* Não Parada HDW */
        if ( CLP.RD(PC_HL_TBGAS_MCTG_NAOPARADA) == 1){
                shpNaoParadaHDW->Brush->Color = clLime;
        }else{
                shpNaoParadaHDW->Brush->Color = clWhite;
        }

/* Partindo Acesa HDW */
        if ( CLP.RD(PC_HL_TBGAS_MCTG_PRTNDACESA) == 1){
                shpPartindoAcesaHDW->Brush->Color = clLime;
        }else{
                shpPartindoAcesaHDW->Brush->Color = clWhite;
        }

/* Em Operação HDW */
        if ( CLP.RD(PC_HL_TBGAS_MCTG_EMOPERACAO) == 1){
                shpEmOperacaoHDW->Brush->Color = clLime;
        }else{
                shpEmOperacaoHDW->Brush->Color = clWhite;
        }

/* Em Local */
        if ( CLP.RD(PC_HL_TBGAS_MCTG_PARANDO) == 1){
                shpParandoHDW->Brush->Color = clRed;
        }else{
                shpParandoHDW->Brush->Color = clWhite;
        }

/* Partida Normal Selecionada */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_PTDNORMSEL) == 1 || CLP.RD(PC_HL_TBGAS_MCTG_PRTNDONORM) == 1){
                shpPartidaNormalSel->Brush->Color = clLime;
        }else{
                shpPartidaNormalSel->Brush->Color = clWhite;
        }

/* Partida Rápida Selecionada */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_PTDRAPSEL) == 1 || CLP.RD(PC_HL_TBGAS_MCTG_PRTNDORAPD) == 1){
                shpPartidaRapidaSel->Brush->Color = clYellow;
        }else{
                shpPartidaRapidaSel->Brush->Color = clWhite;
        }

/* NÍVEL BAIXO TQ DRENOS MANFOLD */
        if ( CLP.RD(PC_HL_AOLTG_TQDREN_NIVELALTO) == 1){
                frmPermissivos->shpTQDREN_NIVELALTO->Brush->Color = clLime;
                frmPermissivos->btnTQDREN_NIVELALTO->Caption = "TQ DREN NÃO NV ALTO";
        }else{
                frmPermissivos->shpTQDREN_NIVELALTO->Brush->Color = clRed;
                frmPermissivos->btnTQDREN_NIVELALTO->Caption = "TQ DREN NV ALTO";
        }

/* BLQ MANUAL PTDA NÃO ATIVADO (CHAVE NO CCM) */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_PERMPTDATLASOK) == 1){
                frmPermissivos->shpPERMPTDATLASOK->Brush->Color = clLime;
                frmPermissivos->btnPERMPTDATLASOK->Caption = "BLQ INATIVO";
        }else{
                frmPermissivos->shpPERMPTDATLASOK->Brush->Color = clRed;
                frmPermissivos->btnPERMPTDATLASOK->Caption = "BLQ ATIVO";
        }

/* NÍVEL OL TQ MOD. LUB. NORMAL */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_PERMPTDOLNVOK) == 1){
                frmPermissivos->shpPERMPTDOLNVOK->Brush->Color = clLime;
                frmPermissivos->btnPERMPTDOLNVOK->Caption = "MOD. LUB. NV. OK";
        }else{
                frmPermissivos->shpPERMPTDOLNVOK->Brush->Color = clRed;
                frmPermissivos->btnPERMPTDOLNVOK->Caption = "MOD. LUB. NV. NÃO OK";
        }

/* (TEMPERATURAS OL NORMAIS ( POCETOS E MOD. LUBRIF.) */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_PERMPTDLUBOK) == 1){
                frmPermissivos->shpPERMPTDLUBOK->Brush->Color = clLime;
                frmPermissivos->btnPERMPTDLUBOK->Caption = "MOD. LUB. TEMP. OK";
        }else{
                frmPermissivos->shpPERMPTDLUBOK->Brush->Color = clRed;
                frmPermissivos->btnPERMPTDLUBOK->Caption = "MOD. LUB. TEMP. NÃO OK";
        }

/* VV SANGRIA AR FECHADA */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_ABVFEC) == 1 && CLP.RD(PC_SL_TBGAS_ATLAS_ABVABT) == 0){
                frmPermissivos->shpABVFEC->Brush->Color = clLime;
                frmPermissivos->shpABV->Caption = "ABV FECHADA";
        }else{
                if ( CLP.RD(PC_SL_TBGAS_ATLAS_ABVFEC) == 0 && CLP.RD(PC_SL_TBGAS_ATLAS_ABVABT) == 1){
                        frmPermissivos->shpABVFEC->Brush->Color = clRed;
                        frmPermissivos->shpABV->Caption = "ABV ABERTA";
                }else{
                        frmPermissivos->shpABVFEC->Brush->Color = clWhite;
                        frmPermissivos->shpABV->Caption = "ABV INDEFINIDA";
                }
        }

/* PRESSÃO SUPRIMENTO COMBUSTÍVEL OK (0.34 A 0.45 BAR) */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_PERMPTDODPOK) == 1){
                frmPermissivos->shpPERMPTDODPOK->Brush->Color = clLime;
                frmPermissivos->btnPERMPTDODPOK->Caption = "PRESS. OD. OK";
        }else{
                frmPermissivos->shpPERMPTDODPOK->Brush->Color = clRed;
                frmPermissivos->btnPERMPTDODPOK->Caption = "PRESS. OD. NÃO OK";
        }

/* TEMP SUPRIMENTO COMBUSTÍVEL OK (0°C A 70°C) */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_PERMPTDODTOK) == 1){
                frmPermissivos->shpPERMPTDODTOK->Brush->Color = clLime;
                frmPermissivos->btnPERMPTDODTOK->Caption = "TEMP. OD. OK";
        }else{
                frmPermissivos->shpPERMPTDODTOK->Brush->Color = clRed;
                frmPermissivos->btnPERMPTDODTOK->Caption = "TEMP. OD. NÃO OK";
        }

/* PLA NO MINIMO */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_PLAEMIDLE) == 1){
                frmPermissivos->shpPLAEMIDLE->Brush->Color = clLime;
                frmPermissivos->btnPLAEMIDLE->Caption = "PLA NO MÍNIMO";
        }else{
                frmPermissivos->shpPLAEMIDLE->Brush->Color = clRed;
                frmPermissivos->btnPLAEMIDLE->Caption = "NÃO PLA NO MÍNIMO";
        }

/* PLA LIMITADO AO MINIMO (CTRL)*/
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_LIMPLAATUANDO) == 1){
                frmPermissivos->shpLIMPLAATUANDO->Brush->Color = clLime;
                frmPermissivos->btnLIMPLAATUANDO->Caption = "PLA LIM. MÍNIMO";
        }else{
                frmPermissivos->shpLIMPLAATUANDO->Brush->Color = clRed;
                frmPermissivos->btnLIMPLAATUANDO->Caption = "NÃO PLA LIM. MÍNIMO";
        }

/* IGNIÇÃO SEM FALHAS */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_PERMPTDIGNOK) == 1){
                frmPermissivos->shpPERMPTDIGNOK->Brush->Color = clLime;
                frmPermissivos->btnPERMPTDIGNOK->Caption = "IGNÇÃO OK";
        }else{
                frmPermissivos->shpPERMPTDIGNOK->Brush->Color = clRed;
                frmPermissivos->btnPERMPTDIGNOK->Caption = "IGNÇÃO NÃO OK";
        }

/* NGG < 300 RPM */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_PERMPTDNGGBX) == 1){
                frmPermissivos->shpPERMPTDNGGBX->Brush->Color = clLime;
                frmPermissivos->btnPERMPTDNGGBX->Caption = "NGG BX (< 300 RPM)";
        }else{
                frmPermissivos->shpPERMPTDNGGBX->Brush->Color = clRed;
                frmPermissivos->btnPERMPTDNGGBX->Caption = "NGG NÃO BX (> 300 RPM)";
        }

/* VV EXT COMB FECHADA (VOD 116) */
        if ( CLP.RD(CP_SL_TBGAS_ETH1_ABRIRVVEXTOD) == 1){
                shpAbrirVOD116ETH1->Brush->Color = clRed;
        }else{
                shpAbrirVOD116ETH1->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH2_ABRIRVVEXTOD) == 1){
                shpAbrirVOD116ETH2->Brush->Color = clRed;
        }else{
                shpAbrirVOD116ETH2->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH1_ABRIRVVEXTOD) == 1 || CLP.RD(CP_SL_TBGAS_ETH2_ABRIRVVEXTOD) == 1){
                if ( ack_abrir_vod116 == false){
                        ack_abrir_vod116 = true;
                        tmrFecharVOD116->Enabled = false;
                        if ( tmrAbrirVOD116->Enabled == false ){
                                tmrAbrirVOD116->Enabled = true;
                        }
                }
        }

        if ( CLP.RD(CP_SL_TBGAS_ETH1_FECHARVVEXTOD) == 1){
                shpFecharVOD116ETH1->Brush->Color = clLime;
        }else{
                shpFecharVOD116ETH1->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH2_FECHARVVEXTOD) == 1){
                shpFecharVOD116ETH2->Brush->Color = clLime;
        }else{
                shpFecharVOD116ETH2->Brush->Color = clWhite;
        }
        if ( CLP.RD(CP_SL_TBGAS_ETH1_FECHARVVEXTOD) == 1 || CLP.RD(CP_SL_TBGAS_ETH2_FECHARVVEXTOD) == 1){
                if ( ack_fechar_vod116 == false){
                        ack_fechar_vod116 = true;
                        tmrAbrirVOD116->Enabled = false;
                        if ( tmrFecharVOD116->Enabled == false ){
                                tmrFecharVOD116->Enabled = true;
                        }
                }
        }


        if ( CLP.RD(PC_SL_TBGAS_ATLAS_VVEXTODFECH) == 1 && CLP.RD(PC_SL_TBGAS_ATLAS_VVEXTODABT) == 0){
                frmPermissivos->shpVVEXTODFECH->Brush->Color = clLime;
                frmPermissivos->btnVVEXTOD->Caption = "VV EXT OD FECHADA";
                shpVVEXTODFECH->Brush->Color = clLime;
        }else{
                if ( CLP.RD(PC_SL_TBGAS_ATLAS_VVEXTODFECH) == 0 && CLP.RD(PC_SL_TBGAS_ATLAS_VVEXTODABT) == 1){
                        frmPermissivos->shpVVEXTODFECH->Brush->Color = clRed;
                        frmPermissivos->btnVVEXTOD->Caption = "VV EXT OD ABERTA";
                        shpVVEXTODFECH->Brush->Color = clRed;
                }else{
                        frmPermissivos->shpVVEXTODFECH->Brush->Color = clWhite;
                        frmPermissivos->btnVVEXTOD->Caption = "VV EXT OD INDEFINIDA";
                        shpVVEXTODFECH->Brush->Color = clWhite;
                }
        }

/* VÁLVULA DE AR DE PARTIDA FECHADA*/
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_ASOVFECH) == 1){
                frmPermissivos->shpASOVFECH->Brush->Color = clLime;
                frmPermissivos->btnASOVFECH->Caption = "ASOV FECHADA";
        }else{
                frmPermissivos->shpASOVFECH->Brush->Color = clRed;
                frmPermissivos->btnASOVFECH->Caption = "ASOV ABERTA";
        }

/* STARTER FRIO */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_ARRANQUEOK) == 1){
                frmPermissivos->shpARRANQUEOK->Brush->Color = clLime;
                frmPermissivos->btnARRANQUEOK->Caption = "ARRANQUE OK";
        }else{
                frmPermissivos->shpARRANQUEOK->Brush->Color = clRed;
                frmPermissivos->btnARRANQUEOK->Caption = "ARRANQUE NÃO OK";
        }

/* SET POINT DE NTP BAIXO */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_PERMPTDSPNTPBX) == 1){
                frmPermissivos->shpPERMPTDSPNTPBX->Brush->Color = clLime;
                frmPermissivos->btnPERMPTDSPNTPBX->Caption = "SP NTP BAIXO";
        }else{
                frmPermissivos->shpPERMPTDSPNTPBX->Brush->Color = clRed;
                frmPermissivos->btnPERMPTDSPNTPBX->Caption = "SP NTP NÃO BAIXO";
        }

/* SET POINT DE NTP */
        lblSPNTPEHT1->Caption = CLP.RD(CP_SA_TBGAS_ETH1_SPSCMNTP);
        lblSPNTPEHT2->Caption = CLP.RD(CP_SA_TBGAS_ETH2_SPSCMNTP);
        if (em_local == false){
                if (lblSPNTPEHT1->Caption.ToInt() >= lblSPNTPEHT2->Caption.ToInt()){
                        sp_ntp = lblSPNTPEHT1->Caption.ToInt();
                }else{
                        sp_ntp = lblSPNTPEHT2->Caption.ToInt();
                }
        }else{
                sp_ntp = lblDemandaLocal->Caption.ToInt();
        }

        if (sp_ntp < ntp_min){
                sp_ntp = ntp_min;
        }



/* SET POINT DE PLA */
        lblSPPLAEHT1->Caption = CLP.RD(CP_SA_TBGAS_ETH1_SPSCMPLA)/10;
        lblSPPLAEHT2->Caption = CLP.RD(CP_SA_TBGAS_ETH2_SPSCMPLA)/10;
        if (em_local == false){
                if (lblSPPLAEHT1->Caption.ToDouble() >= lblSPPLAEHT2->Caption.ToDouble()){
                        sp_pla = lblSPPLAEHT1->Caption.ToDouble();
                }else{
                        sp_pla = lblSPPLAEHT2->Caption.ToDouble();
                }

        }else{
                //sp_pla = lblDemandaLocal->Caption.ToInt();
        }

        if (sp_pla < pla_min){
                sp_pla = pla_min;
        }
/* Low Crank */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_MOTORIZBPSEL) == 1){
                shpLOWCRANK->Brush->Color = clYellow;
                shpMotLenta->Pen->Color = clYellow;
                crank_liberado = false;
        }else{
                shpLOWCRANK->Brush->Color = clWhite;
                shpMotLenta->Pen->Color = clBlack;
        }

/* High Crank */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_MOTORIZAPSEL) == 1){
                shpHIGHCRANK->Brush->Color = clYellow;
                shpMotRapida->Pen->Color = clYellow;
                crank_liberado = false;
        }else{
                shpHIGHCRANK->Brush->Color = clWhite;
                shpMotRapida->Pen->Color = clBlack;
        }

/* Motorizando após falha de acendimento */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_PURGAMOTLENTA) == 1){
                shpPURGAMOTLENTA->Brush->Color = clRed;
                crank_liberado = false;
        }else{
                shpPURGAMOTLENTA->Brush->Color = clWhite;
        }

/* Fora de Serviço */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_FORADESERVICO) == 1){
                shpFORADESERVICO->Brush->Color = clRed;
                crank_liberado = false;
        }else{
                shpFORADESERVICO->Brush->Color = clWhite;
        }

/* Controle em MODO PLA */
        if ( CLP.RD(CP_HL_TBGAS_MCTG_ATVPLAMANUAL) == 1 ){
                shpAtivarModoPLA->Brush->Color = clYellow;
                if ( ack_ativar_pla == false ){
                        if ( em_local == false){
                                CLP.WR(PC_SL_TBGAS_ATLAS_PLAEMMAN, 1);
                        }
                        ack_ativar_pla = true;
                }
        }else{
                shpAtivarModoPLA->Brush->Color = clWhite;
                ack_ativar_pla = false;
                if ( ModoNTP == false && em_local == false){
                        CLP.WR(PC_SL_TBGAS_ATLAS_PLAEMMAN, 0);
                }
        }

        if ( CLP.RD(PC_SL_TBGAS_ATLAS_PLAEMMAN) == 1){
                shpModoNTP->Brush->Color = clWhite;
                shpModoPLA->Brush->Color = clLime;
                ModoNTP = false;
                ModoPLA = true;
        }else{
                shpModoPLA->Brush->Color = clWhite;
                shpModoNTP->Brush->Color = clLime;
                ModoPLA = false;
                ModoNTP = true;
                /*if ( ntp_atual < sp_ntp){
                        rotacao_calc = ntp_atual;
                }else{
                        rotacao_calc = sp_ntp;
                }
                pla_atual = (((rotacao_calc - ntp_min) * (pla_max - pla_min))/(ntp_max - ntp_min)) + pla_min;
                if (pla_atual < 0) {
                        pla_atual = 0;
                }
                if (pla_atual != lblPLA->Caption.ToDouble()) {
                        CLP.WR(PC_HA_TBGAS_MCTG_PLA  , pla_atual);
                        CLP.WR(PC_SA_TBGAS_ATLAS_PLA , pla_atual);
                }*/
        }
        //ngg_atual = ntp_atual * multip_ngg;
        //ngg_atual = (((rotacao_calc - ntp_min) * (ngg_max - ngg_min))/(ntp_max - ntp_min)) + ngg_min;
        /*if (rotacao_calc <= 0 ){
                ngg_atual = 0;
        }
        if (ngg_atual != lblNGG->Caption.ToInt() ){
                CLP.WR(PC_SA_TBGAS_ATLAS_NGG , ngg_atual);
                CLP.WR(PC_HA_TBGAS_MCTG_NGG  , ngg_atual);
        } */

        lblNGG->Caption = CLP.RD(PC_HA_TBGAS_MCTG_NGG);
        //ngg_atual = lblNGG->Caption.ToInt();
        //PC_SA_TBGAS_ATLAS_NGG

        lblPLA->Caption = FormatFloat( "##0.##", CLP.RD(PC_HA_TBGAS_MCTG_PLA));
        //pla_atual = lblPLA->Caption.ToInt();
        //PC_SA_TBGAS_ATLAS_PLA

        lblNTP->Caption = CLP.RD(PC_SA_TBGAS_ATLAS_NTP);
        //ntp_atual = lblNTP->Caption.ToInt();
        //PC_HA_TBGAS_MCTG_NTP

/* Qualquer Trip */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_QQTRIP) == 1){
                shpQQTRIP->Brush->Color = clRed;
                if ( silenciar_sirene == false ){
                        mplAudio->Play();
                }
        }else{
                shpQQTRIP->Brush->Color = clWhite;
                mplAudio->Stop();
                silenciar_sirene = false;
        }

/* Qualquer Trip */
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_QQALARME) == 1){
                shpQQALARME->Brush->Color = clRed;
                //if ( silenciar_sirene == false ){
                //        mplAudio->Play();
                //}
        }else{
                shpQQALARME->Brush->Color = clWhite;
                //        mplAudio->Stop();
        }

        btnLowCrank->Enabled = crank_liberado && em_local;
        btnHighCrank->Enabled = crank_liberado && em_local;

        btnPartirLocal->Enabled = em_local;
        btnPartirRLocal->Enabled = em_local;
        btnPararLocal->Enabled = em_local;
        btnBatOver1Loc->Enabled = em_local;
        btnBatOver2Loc->Enabled = em_local;
        btnAclNTP->Enabled = em_local;
        btnDaclNTP->Enabled = em_local;
        txtSETNTP->Enabled = em_local;
        btnSETNTP->Enabled = em_local;
        btnRearmar->Enabled = em_parada_emerg;
        btnPararEmergLoc->Enabled = em_local;

        if (ack_partir_normal == true){
                ACK01->Brush->Color = clLime;
        }else{
                ACK01->Brush->Color = clWhite;
        }
        if (ack_partir_rapido == true){
                ACK02->Brush->Color = clLime;
        }else{
                ACK02->Brush->Color = clWhite;
        }
        if (ack_parar_normal == true){
                ACK03->Brush->Color = clLime;
        }else{
                ACK03->Brush->Color = clWhite;
        }
        if (ack_parar_emergencia == true){
                ACK04->Brush->Color = clLime;
        }else{
                ACK04->Brush->Color = clWhite;
        }
        if (ack_parar_incendio == true){
                ACK05->Brush->Color = clLime;
        }else{
                ACK05->Brush->Color = clWhite;
        }
        if (ack_abrir_vod116 == true){
                ACK06->Brush->Color = clLime;
        }else{
                ACK06->Brush->Color = clWhite;
        }
        if (ack_fechar_vod116 == true){
                ACK07->Brush->Color = clLime;
        }else{
                ACK07->Brush->Color = clWhite;
        }
        if (ack_ativar_pla == true){
                ACK08->Brush->Color = clLime;
        }else{
                ACK08->Brush->Color = clWhite;
        }
}
//---------------------------------------------------------------------------
void __fastcall TfrmPrincipal::tmrPartidaTimer(TObject *Sender)
{
        lblContaPartida->Caption = (String) contador_partida + " segundos";

        if (CLP.RD(PC_SL_TBGAS_ATLAS_RESFEMRALANTI) == 1 || resfriando_tg_acesa == true){
                CLP.WR(PC_HL_TBGAS_MCTG_PARANDO        , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_RESFEMRALANTI , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_PRTNDONORM     , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_PRTNDORAPD     , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_NAOPARADA      , 1);
                CLP.WR(PC_HL_TBGAS_MCTG_PRTNDACESA     , 1);
                CLP.WR(PC_HL_TBGAS_MCTG_EMOPERACAO     , 1);
                CLP.WR(PC_SL_TBGAS_ATLAS_EMOPERACAO    , 1);
                CLP.WR(PC_SL_TBGAS_ATLAS_TGVIRANDO     , 1);
                em_operacao = true;
        }

        if (contador_partida == 0 && em_operacao == false){
                CLP.WR(PC_SL_TBGAS_ATLAS_RESFEMRALANTI , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_NAOPARADA      , 1);
                CLP.WR(PC_HL_TBGAS_MCTG_PRTNDACESA     , 1);
                CLP.WR(PC_SL_TBGAS_ATLAS_ATIVANDOAUXIL , 1);
                CLP.WR(PC_SA_TBGAS_ATLAS_PLA           , 0);
                CLP.WR(PC_HA_TBGAS_MCTG_PLA            , 0);
                CLP.WR(PC_SA_TBGAS_ATLAS_NTP           , ntp_etapa_01);
                CLP.WR(PC_HA_TBGAS_MCTG_NTP            , ntp_etapa_01);
                ntp_atual = ntp_etapa_01;
                CLP.WR(PC_SA_TBGAS_ATLAS_NGG           , 1500);
                CLP.WR(PC_HA_TBGAS_MCTG_NGG            , 1500);
        }
        if (contador_partida == 3 && em_operacao == false){
                //CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODFECH   , 0);
                //CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODABT    , 1);
                CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_ATIVANDOAUXIL , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_ACELPRAQUEIMA , 1);
                CLP.WR(PC_SA_TBGAS_ATLAS_PLA           , 0);
                CLP.WR(PC_HA_TBGAS_MCTG_PLA            , 0);
                CLP.WR(PC_SA_TBGAS_ATLAS_NTP           , ntp_etapa_02);
                CLP.WR(PC_HA_TBGAS_MCTG_NTP            , ntp_etapa_02);
                ntp_atual = ntp_etapa_02;
                CLP.WR(PC_SA_TBGAS_ATLAS_NGG           , 2000);
                CLP.WR(PC_HA_TBGAS_MCTG_NGG            , 2000);
        }
        if (contador_partida == 6 && em_operacao == false){
                CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_ACELPRAQUEIMA , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_APLICANDOOD   , 1);
        }
        if (contador_partida == 7 && em_operacao == false){
                CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODFECH   , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODABT    , 1);
        }
        if (contador_partida == 9 && em_operacao == false){
                CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_APLICANDOOD   , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_ACELPRARALANTI, 1);
                CLP.WR(PC_SA_TBGAS_ATLAS_PLA           , 0);
                CLP.WR(PC_HA_TBGAS_MCTG_PLA            , 0);
                CLP.WR(PC_SA_TBGAS_ATLAS_NTP           , ntp_min);
                CLP.WR(PC_HA_TBGAS_MCTG_NTP            , ntp_min);
                ntp_atual = ntp_min;
                CLP.WR(PC_SA_TBGAS_ATLAS_NGG           , 5000);
                CLP.WR(PC_HA_TBGAS_MCTG_NGG            , 5000);
        }
        if (contador_partida == 12 && partida_normal == true && partida_rapida == false && em_operacao == false){
                CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_ACELPRARALANTI, 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_AQCTGEMRALANTI, 1);
        }
        if (contador_partida >= 12 && partida_normal == false && partida_rapida == true && em_operacao == false){
                CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_ACELPRARALANTI, 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_AQCTGEMRALANTI, 0);
                CLP.WR(PC_HL_TBGAS_MCTG_PRTNDORAPD     , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_TGVIRANDO     , 1);
                CLP.WR(PC_HL_TBGAS_MCTG_EMOPERACAO     , 1);
                CLP.WR(PC_SL_TBGAS_ATLAS_EMOPERACAO    , 1);

                em_operacao = true;
        }
        if (contador_partida == 32 && partida_normal == true && partida_rapida == false && em_operacao == false){
                CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_AQCTGEMRALANTI, 0);
                CLP.WR(PC_HL_TBGAS_MCTG_PRTNDONORM     , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_TGVIRANDO     , 1);
                CLP.WR(PC_HL_TBGAS_MCTG_EMOPERACAO     , 1);
                CLP.WR(PC_SL_TBGAS_ATLAS_EMOPERACAO    , 1);
                em_operacao = true;
        }

        contador_partida++;

        if ( contador_partida > 32 || em_operacao == true){
                contador_partida = 0;
                lblContaPartida->Caption = (String) contador_partida + " segundos";
                ack_partir_rapido = false;
                ack_partir_normal = false;
                tmrPartida->Enabled = false;
        }

}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnEmRemLocClick(TObject *Sender)
{
        if (btnEmRemLoc->Caption == "Em Local"){
                CLP.WR(PC_HL_TBGAS_MCTG_EMLOCAL        , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_EMREMOTO      , 1);
                CLP.WR(PC_HL_TBGAS_MCTG_EMREMOTO       , 1);
                btnEmRemLoc->Caption == "Em Remoto";
                if (ack_ativar_pla == true){
                        CLP.WR(PC_SL_TBGAS_ATLAS_PLAEMMAN      , 1);
                }
                /*btnPartirLocal->Enabled = false;
                btnPartirRLocal->Enabled = false;
                btnPararLocal->Enabled = false;
                btnHighCrank->Enabled = false;
                btnLowCrank->Enabled = false;
                btnBatOver1Loc->Enabled = false;
                btnBatOver2Loc->Enabled = false;*/
        }
        else{
                if (btnEmRemLoc->Caption == "Em Remoto"){
                        CLP.WR(PC_SL_TBGAS_ATLAS_EMREMOTO      , 0);
                        CLP.WR(PC_HL_TBGAS_MCTG_EMREMOTO       , 0);
                        CLP.WR(PC_HL_TBGAS_MCTG_EMLOCAL        , 1);
                        CLP.WR(PC_SL_TBGAS_ATLAS_PLAEMMAN      , 0);
                        btnEmRemLoc->Caption == "Em Local";
                        /*btnPartirLocal->Enabled = true;
                        btnPartirRLocal->Enabled = true;
                        btnPararLocal->Enabled = true;
                        btnHighCrank->Enabled = true;
                        btnLowCrank->Enabled = true;
                        btnBatOver1Loc->Enabled = true;
                        btnBatOver2Loc->Enabled = true;*/
                }
        }
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::FormClose(TObject *Sender,
      TCloseAction &Action)
{
        CLP.Close();
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::tmrParadaTimer(TObject *Sender)
{
        lblContaParada->Caption = (String) contador_parada + " segundos";

        bool tg_parada = false;

        if (CLP.RD(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK) == 1){
                tg_parada = true;
        }

        if (contador_parada == 0 && tg_parada == false && crank == false && em_parada_emerg == false){
                CLP.WR(PC_SL_TBGAS_ATLAS_ATIVANDOAUXIL , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_ACELPRAQUEIMA , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_APLICANDOOD   , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_ACELPRARALANTI, 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_AQCTGEMRALANTI, 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_EMOPERACAO    , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_EMOPERACAO     , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_TGVIRANDO     , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_PRTNDACESA     , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_PARANDO        , 1);
                CLP.WR(PC_SL_TBGAS_ATLAS_RESFEMRALANTI , 1);
                CLP.WR(PC_SA_TBGAS_ATLAS_PLA           , 0);
                CLP.WR(PC_HA_TBGAS_MCTG_PLA            , 0);
                CLP.WR(PC_SA_TBGAS_ATLAS_NTP           , ntp_min);
                CLP.WR(PC_HA_TBGAS_MCTG_NTP            , ntp_min);
                ntp_atual = ntp_min;
                CLP.WR(PC_SA_TBGAS_ATLAS_NGG           , 5000);
                CLP.WR(PC_HA_TBGAS_MCTG_NGG            , 5000);
                em_operacao = false;
                resfriando_tg_acesa = true;
        }
        if (contador_parada == 20 && (tg_parada == false || crank == true || em_parada_emerg == true)){
                CLP.WR(PC_SL_TBGAS_ATLAS_MOTORIZAPSEL  , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_MOTORIZBPSEL  , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_RESFEMRALANTI , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_PRTNDACESA     , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_PARANDO        , 1);
                CLP.WR(PC_SL_TBGAS_ATLAS_EMCOASTDOWN   , 1);
                CLP.WR(PC_SA_TBGAS_ATLAS_PLA           , 0);
                CLP.WR(PC_HA_TBGAS_MCTG_PLA            , 0);
                CLP.WR(PC_SA_TBGAS_ATLAS_NTP           , ntp_etapa_03);
                CLP.WR(PC_HA_TBGAS_MCTG_NTP            , ntp_etapa_03);
                ntp_atual = ntp_etapa_03;
                CLP.WR(PC_SA_TBGAS_ATLAS_NGG           , 3000);
                CLP.WR(PC_HA_TBGAS_MCTG_NGG            , 3000);
                resfriando_tg_acesa = false;
        }
        if (contador_parada == 30 && (tg_parada == false || crank == true)){
                CLP.WR(PC_SL_TBGAS_ATLAS_EMCOASTDOWN   , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_PARANDO        , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_PRTNDACESA     , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_NAOPARADA      , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_PARADA        , 1);
                CLP.WR(PC_SA_TBGAS_ATLAS_PLA           , 0);
                CLP.WR(PC_HA_TBGAS_MCTG_PLA            , 0);
                CLP.WR(PC_SA_TBGAS_ATLAS_NTP           , 0);
                CLP.WR(PC_HA_TBGAS_MCTG_NTP            , 0);
                ntp_atual = 0;
                CLP.WR(PC_SA_TBGAS_ATLAS_NGG           , 2000);
                CLP.WR(PC_HA_TBGAS_MCTG_NGG            , 2000);
                CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODFECH   , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODABT    , 1);
        }
        if (contador_parada == 35 && (tg_parada == false || crank == true) && em_parada_emerg == false){
                CLP.WR(PC_SL_TBGAS_ATLAS_PARADA        , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_OKPARACRANK   , 1);
                CLP.WR(PC_SA_TBGAS_ATLAS_PLA           , 0);
                CLP.WR(PC_HA_TBGAS_MCTG_PLA            , 0);
                CLP.WR(PC_SA_TBGAS_ATLAS_NTP           , 0);
                CLP.WR(PC_HA_TBGAS_MCTG_NTP            , 0);
                ntp_atual = 0;
                CLP.WR(PC_SA_TBGAS_ATLAS_NGG           , 500);
                CLP.WR(PC_HA_TBGAS_MCTG_NGG            , 500);
                CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODABT    , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODFECH   , 1);
        }
        if (contador_parada == 40 && (tg_parada == false || crank == true)){
                CLP.WR(PC_SL_TBGAS_ATLAS_OKPARACRANK   , 0);
                if (em_parada_emerg == false){
                        CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 1);
                }else{
                        CLP.WR(PC_SL_TBGAS_ATLAS_PARADA        , 0);
                        CLP.WR(PC_SL_TBGAS_ATLAS_FORADESERVICO , 1);
                }
                CLP.WR(PC_SA_TBGAS_ATLAS_PLA           , 0);
                CLP.WR(PC_HA_TBGAS_MCTG_PLA            , 0);
                CLP.WR(PC_SA_TBGAS_ATLAS_NTP           , 0);
                CLP.WR(PC_HA_TBGAS_MCTG_NTP            , 0);
                ntp_atual = 0;
                CLP.WR(PC_SA_TBGAS_ATLAS_NGG           , 0);
                CLP.WR(PC_HA_TBGAS_MCTG_NGG            , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODABT    , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODFECH   , 1);
                tg_parada = true;
        }

        contador_parada++;

        if ( contador_parada > 40 || tg_parada == true){
                contador_parada = 0;
                lblContaParada->Caption = (String) contador_parada + " segundos";
                ack_parar_normal = false;
                partida_rapida = false;
                CLP.WR(PC_SL_TBGAS_ATLAS_PTDRAPSEL     , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_PRTNDORAPD     , 0);
                partida_normal = false;
                CLP.WR(PC_SL_TBGAS_ATLAS_PTDNORMSEL    , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_PRTNDONORM     , 0);
                //ack_parar_emergencia = false;
                if (ack_partir_rapido == true || ack_partir_normal == true){
                        ack_partir_rapido = false;
                        ack_partir_normal = false;
                }
                tmrParada->Enabled = false;
        }
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnPartirLocalClick(TObject *Sender)
{
        partida_rapida = false;
        CLP.WR(PC_SL_TBGAS_ATLAS_PTDRAPSEL     , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_PRTNDORAPD     , 0);
        partida_normal = true;
        CLP.WR(PC_SL_TBGAS_ATLAS_PTDNORMSEL    , 1);
        CLP.WR(PC_HL_TBGAS_MCTG_PRTNDONORM     , 1);
        tmrParada->Enabled = false;
        contador_parada = 0;
        lblContaParada->Caption = (String) contador_parada + " segundos";
        if ( tmrPartida->Enabled == false ){
                tmrPartida->Enabled = true;
        }
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnPararLocalClick(TObject *Sender)
{
        tmrPartida->Enabled = false;
        contador_partida = 0;
        lblContaPartida->Caption = (String) contador_partida + " segundos";
        tmrParada->Enabled = true;
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnPartirRLocalClick(TObject *Sender)
{
        partida_normal = false;
        CLP.WR(PC_SL_TBGAS_ATLAS_PTDNORMSEL    , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_PRTNDONORM     , 0);
        partida_rapida = true;
        CLP.WR(PC_SL_TBGAS_ATLAS_PTDRAPSEL     , 1);
        CLP.WR(PC_HL_TBGAS_MCTG_PRTNDORAPD     , 1);
        tmrParada->Enabled = false;
        contador_parada = 0;
        lblContaParada->Caption = (String) contador_parada + " segundos";
        if ( tmrPartida->Enabled == false ){
                tmrPartida->Enabled = true;
        }
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::Button1Click(TObject *Sender)
{
        frmPermissivos->Top = frmPrincipal->Top + 20;
        frmPermissivos->Left = frmPrincipal->Left + 200;
        frmPermissivos->ShowModal();
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnInibirPartidaClick(TObject *Sender)
{
        if ( inibir_partida == false ){
                btnInibirPartida->Caption = "Partida Inibida";
                shpInibiPartida->Pen->Color = clRed;
                inibir_partida = true;
        }else{
                btnInibirPartida->Caption = "Partida Liberada";
                shpInibiPartida->Pen->Color = clBlack;
                inibir_partida = false;
        }
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnInibirParadaClick(TObject *Sender)
{
        if ( inibir_parada == false ){
                btnInibirParada->Caption = "Parada Inibida";
                shpInibiParada->Pen->Color = clRed;
                inibir_parada = true;
        }else{
                btnInibirParada->Caption = "Parada Liberada";
                shpInibiParada->Pen->Color = clBlack;
                inibir_parada = false;
        }
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnLowCrankClick(TObject *Sender)
{
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_MOTORIZBPSEL) == 1){
                CLP.WR(PC_SL_TBGAS_ATLAS_MOTORIZBPSEL, 0);
                crank = false;
        }else{
                CLP.WR(PC_SL_TBGAS_ATLAS_OKPARACRANK   , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_NAOPARADA      , 1);
                CLP.WR(PC_SL_TBGAS_ATLAS_MOTORIZBPSEL  , 1);
                CLP.WR(PC_SA_TBGAS_ATLAS_NTP           , ntp_etapa_00);
                CLP.WR(PC_HA_TBGAS_MCTG_NTP            , ntp_etapa_00);
                contador_parada = 10;
                crank = true;
                tmrParada->Enabled = true;
        }
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnHighCrankClick(TObject *Sender)
{
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_MOTORIZAPSEL) == 1){
                CLP.WR(PC_SL_TBGAS_ATLAS_MOTORIZAPSEL, 0);
                crank = false;
        }else{
                CLP.WR(PC_SL_TBGAS_ATLAS_OKPARACRANK   , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 0);
                CLP.WR(PC_HL_TBGAS_MCTG_NAOPARADA      , 1);
                CLP.WR(PC_SL_TBGAS_ATLAS_MOTORIZAPSEL  , 1);
                CLP.WR(PC_SA_TBGAS_ATLAS_NTP           , ntp_etapa_01);
                CLP.WR(PC_HA_TBGAS_MCTG_NTP            , ntp_etapa_01);
                contador_parada = 15;
                crank = true;
                tmrParada->Enabled = true;
        }
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnBatOver1LocClick(TObject *Sender)
{
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_OVERRIDE1ATIV) == 1 || CLP.RD(PC_HL_TBGAS_MCTG_OVERRIDE1) == 1){
                ack_parar_lig_batover1 = false;
                CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE1LOC , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE1ATIV, 0);
                CLP.WR(PC_HL_TBGAS_MCTG_OVERRIDE1     , 0);
        }else{
                ack_parar_lig_batover1 = true;
                CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE1LOC , 1);
                CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE1ATIV, 1);
                CLP.WR(PC_HL_TBGAS_MCTG_OVERRIDE1     , 1);
        }
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnBatOver2LocClick(TObject *Sender)
{
        if ( CLP.RD(PC_SL_TBGAS_ATLAS_OVERRIDE2ATIV) == 1 || CLP.RD(PC_HL_TBGAS_MCTG_OVERRIDE2) == 1){
                ack_parar_lig_batover2 = false;
                CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE2LOC , 0);
                CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE2ATIV, 0);
                CLP.WR(PC_HL_TBGAS_MCTG_OVERRIDE2     , 0);
        }else{
                ack_parar_lig_batover1 = true;
                CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE2LOC , 1);
                CLP.WR(PC_SL_TBGAS_ATLAS_OVERRIDE2ATIV, 1);
                CLP.WR(PC_HL_TBGAS_MCTG_OVERRIDE2     , 1);
        }
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::tmrDemandaNTPTimer(TObject *Sender)
{
         if ( sp_ntp == ntp_atual ){
                estabilizado = true;
         }else{
                if ( variar_ntp == false ){
                        estabilizado = false;
                }else{
                        if ( abs(sp_ntp - ntp_atual) == taxa_variacao_ntp ){
                                estabilizado = true;
                        }else{
                                estabilizado = false;
                        }
                }
         }
         if ( em_operacao == true && ModoNTP == true && estabilizado == false){
                if ( (sp_ntp > ntp_atual) ){
                //acelerar
                        if((sp_ntp - ntp_atual) > sp_ntp * 0.20 /*valor_p_ratemax*/){
                                ntp_atual = ntp_atual + rate_max;
                        }else{
                                if((sp_ntp - ntp_atual) >= rate_aprox){
                                        ntp_atual = ntp_atual + rate_aprox;
                                }else{
                                        ntp_atual = ntp_atual + 1;
                                }
                        }
                        CLP.WR(PC_SA_TBGAS_ATLAS_NTP, ntp_atual);
                        CLP.WR(PC_HA_TBGAS_MCTG_NTP , ntp_atual);
                        if ( ntp_atual < sp_ntp){
                                rotacao_calc = ntp_atual;
                        }else{
                                rotacao_calc = sp_ntp;
                        }
                        /*pla_atual = (((rotacao_calc - ntp_min) * (pla_max - pla_min))/(ntp_max - ntp_min)) + pla_min;
                        if (pla_atual < 0) {
                                pla_atual = 0;
                        }
                        if (pla_atual != lblPLA->Caption.ToDouble()) {
                                if (CLP.TamBufWR() < 20){
                                        CLP.WR(PC_HA_TBGAS_MCTG_PLA  , pla_atual);
                                        CLP.WR(PC_SA_TBGAS_ATLAS_PLA , pla_atual);
                                }
                        }
                        ngg_atual = (((rotacao_calc - ntp_min) * (ngg_max - ngg_min))/(ntp_max - ntp_min)) + ngg_min;
                        if (rotacao_calc <= 0 ){
                                ngg_atual = 0;
                        }
                        if (ngg_atual != lblNGG->Caption.ToInt() ){
                                if (CLP.TamBufWR() < 20){
                                        CLP.WR(PC_SA_TBGAS_ATLAS_NGG , ngg_atual);
                                        CLP.WR(PC_HA_TBGAS_MCTG_NGG  , ngg_atual);
                                }
                        } */
                }else{
                        if ( sp_ntp < ntp_atual ){
                                //desacelerar
                                if((ntp_atual - sp_ntp) > rate_max /*sp_ntp * 0.25*/ /*valor_p_ratemax*/){
                                        ntp_atual = ntp_atual - rate_max;

                                }else{
                                        if ((ntp_atual - sp_ntp) >= rate_aprox){
                                                ntp_atual = ntp_atual - rate_aprox;
                                        }else{
                                                ntp_atual = ntp_atual - 1;
                                        }
                                }
                                if ( ntp_atual < 0 ){
                                        CLP.WR(PC_SA_TBGAS_ATLAS_NTP, 0);
                                        CLP.WR(PC_HA_TBGAS_MCTG_NTP , 0);
                                }else{
                                        CLP.WR(PC_SA_TBGAS_ATLAS_NTP, ntp_atual);
                                        CLP.WR(PC_HA_TBGAS_MCTG_NTP , ntp_atual);
                                }
                                if ( ntp_atual < sp_ntp){
                                        rotacao_calc = ntp_atual;
                                }else{
                                        rotacao_calc = sp_ntp;
                                }

                        }
                }
                pla_atual = (((rotacao_calc - ntp_min) * (pla_max - pla_min))/(ntp_max - ntp_min)) + pla_min;
                if (pla_atual < 0) {
                        pla_atual = 0;
                }
                if (pla_atual != lblPLA->Caption.ToDouble()) {
                        if (CLP.TamBufWR() < 20){
                                CLP.WR(PC_HA_TBGAS_MCTG_PLA  , pla_atual);
                                CLP.WR(PC_SA_TBGAS_ATLAS_PLA , pla_atual);
                        }
                }
                ngg_atual = (((rotacao_calc - ntp_min) * (ngg_max - ngg_min))/(ntp_max - ntp_min)) + ngg_min;
                if (rotacao_calc <= 0 ){
                        ngg_atual = 0;
                }
                if (ngg_atual != lblNGG->Caption.ToInt() ){
                        if (CLP.TamBufWR() < 20){
                                CLP.WR(PC_SA_TBGAS_ATLAS_NGG , ngg_atual);
                                CLP.WR(PC_HA_TBGAS_MCTG_NGG  , ngg_atual);
                        }
                }
        }
        String Teste_SP_PLA;
        String Teste_PLA;
        Teste_SP_PLA = FormatFloat( "##0.##", sp_pla);
        Teste_PLA = FormatFloat( "##0.##", pla_atual);
        if ( em_operacao == true && ModoPLA == true){

                /*if ( sp_pla > pla_atual ){ */
                if ( Teste_SP_PLA.ToDouble() > Teste_PLA.ToDouble() ){
                //acelerar
                        if((sp_pla - pla_atual) > rate_max_pla /*sp_pla * 0.20*/ /*valor_p_ratemax*/){
                                pla_atual = pla_atual + rate_max_pla;
                        }else{
                                if((sp_pla - pla_atual) >= rate_aprox_pla){
                                        pla_atual = pla_atual + rate_aprox_pla;
                                }else{
                                        pla_atual = pla_atual +  0.005;
                                }
                        }
                        String PLA_WR = FormatFloat( "##0.##", pla_atual);
                        CLP.WR(PC_HA_TBGAS_MCTG_PLA, PLA_WR.ToDouble());
                        CLP.WR(PC_SA_TBGAS_ATLAS_PLA, PLA_WR.ToDouble());
                        if ( pla_atual < sp_pla){
                                pla_calc = pla_atual;
                        }else{
                                pla_calc = sp_pla;
                        }
                        /*ntp_atual = (((pla_calc - pla_min) * (ntp_max - ntp_min))/(pla_max - pla_min)) + ntp_min;
                        if (ntp_atual < 0) {
                                ntp_atual = 0;
                        }
                        if (ntp_atual != lblNTP->Caption.ToDouble()) {
                                if (CLP.TamBufWR() < 20){
                                        CLP.WR(PC_SA_TBGAS_ATLAS_NTP , ntp_atual);
                                        CLP.WR(PC_HA_TBGAS_MCTG_NTP  , ntp_atual);
                                }
                        }
                        rotacao_calc = ntp_atual;
                        ngg_atual = (((rotacao_calc - ntp_min) * (ngg_max - ngg_min))/(ntp_max - ntp_min)) + ngg_min;
                        if (rotacao_calc <= 0 ){
                                ngg_atual = 0;
                        }
                        if (ngg_atual != lblNGG->Caption.ToInt() ){
                                if (CLP.TamBufWR() < 20){
                                        CLP.WR(PC_SA_TBGAS_ATLAS_NGG , ngg_atual);
                                        CLP.WR(PC_HA_TBGAS_MCTG_NGG  , ngg_atual);
                                }
                        } */                 
                }else{
                        /*if ( sp_pla < pla_atual ){*/
                        if ( Teste_SP_PLA.ToDouble() < Teste_PLA.ToDouble() ){
                                //desacelerar
                                if((pla_atual - sp_pla) > rate_max_pla /*sp_ntp * 0.25*/ /*valor_p_ratemax*/){
                                        pla_atual = pla_atual - rate_max_pla;

                                }else{
                                        if ((pla_atual - sp_pla) >= rate_aprox_pla){
                                                pla_atual = pla_atual - rate_aprox_pla;
                                        }else{
                                                pla_atual = pla_atual - 0.05;
                                        }
                                }
                                if ( pla_atual < 0 ){
                                        CLP.WR(PC_SA_TBGAS_ATLAS_PLA, 0);
                                        CLP.WR(PC_HA_TBGAS_MCTG_PLA , 0);
                                }else{
                                        String PLA_WR = FormatFloat( "##0.##", pla_atual);
                                        CLP.WR(PC_HA_TBGAS_MCTG_PLA, PLA_WR.ToDouble());
                                         CLP.WR(PC_SA_TBGAS_ATLAS_PLA, PLA_WR.ToDouble());
                                }


                        }
                }
                if ( pla_atual < sp_pla){
                        pla_calc = pla_atual;
                }else{
                        pla_calc = sp_pla;
                }
                ntp_atual = (((pla_calc - pla_min) * (ntp_max - ntp_min))/(pla_max - pla_min)) + ntp_min;
                if (ntp_atual < 0) {
                        ntp_atual = 0;
                }
                if (ntp_atual != lblNTP->Caption.ToDouble()) {
                        if (CLP.TamBufWR() < 20){
                                CLP.WR(PC_HA_TBGAS_MCTG_NTP  , ntp_atual);
                                CLP.WR(PC_SA_TBGAS_ATLAS_NTP , ntp_atual);
                        }
                }
                rotacao_calc = ntp_atual;
                ngg_atual = (((rotacao_calc - ntp_min) * (ngg_max - ngg_min))/(ntp_max - ntp_min)) + ngg_min;
                if (rotacao_calc <= 0 ){
                        ngg_atual = 0;
                }
                if (ngg_atual != lblNGG->Caption.ToInt() ){
                        if (CLP.TamBufWR() < 20){
                                CLP.WR(PC_SA_TBGAS_ATLAS_NGG , ngg_atual);
                                CLP.WR(PC_HA_TBGAS_MCTG_NGG  , ngg_atual);
                        }
                }
        }
        if ( variar_ntp == true && estabilizado == true && ModoPLA == false){
                contador_variacao = contador_variacao + 1;
                if ( contador_variacao == 3 ){
                        contador_variacao = 0;
                        if ( varicao_ntp == false ){
                                ntp_atual = ntp_atual + taxa_variacao_ntp;
                                varicao_ntp = true;
                        }else{
                                ntp_atual = ntp_atual - taxa_variacao_ntp;
                                varicao_ntp = false;
                        }
                        CLP.WR(PC_SA_TBGAS_ATLAS_NTP , ntp_atual);
                        CLP.WR(PC_HA_TBGAS_MCTG_NTP  , ntp_atual);
                }
        }else{
                contador_variacao = 0;
                varicao_ntp = false;
        }

}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnAclNTPClick(TObject *Sender)
{
        //CLP.WR(PC_SA_TBGAS_ATLAS_NTP, ntp_atual + rate_aprox);
        //CLP.WR(PC_HA_TBGAS_MCTG_NTP , ntp_atual + rate_aprox);
        lblDemandaLocal->Caption =  ntp_atual + rate_aprox;
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnDaclNTPClick(TObject *Sender)
{
        //CLP.WR(PC_SA_TBGAS_ATLAS_NTP, ntp_atual - rate_aprox);
        //CLP.WR(PC_HA_TBGAS_MCTG_NTP , ntp_atual - rate_aprox);
        lblDemandaLocal->Caption =  ntp_atual - rate_aprox;
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnSETNTPClick(TObject *Sender)
{
        int sett_ntp = 0;

        sett_ntp = txtSETNTP->Text.ToInt();

        //CLP.WR(PC_SA_TBGAS_ATLAS_NTP, ntp_atual - rate_aprox);
        //CLP.WR(PC_HA_TBGAS_MCTG_NTP , ntp_atual - rate_aprox);
        lblDemandaLocal->Caption = sett_ntp;
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnRearmarClick(TObject *Sender)
{
        CLP.WR(PC_HL_TBGAS_MCTG_NAOPARADA      , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_PARANDO        , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_EMCOASTDOWN   , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_QQTRIP        , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PRDEMSCMTRIP  , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PRDEMLOCHWTRIP, 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_QQALARME      , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_QQALARME       , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_QQTRIP         , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_PRDEMERG       , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_FORADESERVICO , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PARADA        , 1);
        contador_parada = 32;
        if ( ack_parar_emergencia == true ){
                ack_parar_emergencia = false;
        }
        if ( ack_parar_incendio == true ){
                ack_parar_incendio = false;
        }
        em_parada_emerg = false;
        tmrParada->Enabled = true;
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnPararEmergLocClick(TObject *Sender)
{
        CLP.WR(PC_SL_TBGAS_ATLAS_OKPARTIRCRANK , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_ATIVANDOAUXIL , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_ACELPRAQUEIMA , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_APLICANDOOD   , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_ACELPRARALANTI, 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_AQCTGEMRALANTI, 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_EMOPERACAO    , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_RESFEMRALANTI , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PARADA        , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_OKPARACRANK   , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_EMMOTORIZRAP  , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_DESACELQUEIMA , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PURGPOSFLACEND, 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PURGAMOTLENTA , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PTDRAPSEL     , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_PTDNORMSEL    , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_PRTNDACESA     , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_EMOPERACAO     , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_PRTNDORAPD     , 0);
        CLP.WR(PC_HL_TBGAS_MCTG_PRTNDONORM     , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_MOTORIZAPSEL  , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_MOTORIZBPSEL  , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_TGVIRANDO     , 0);
        //CLP.WR(PC_HL_TBGAS_MCTG_PARANDO        , 1);
        //CLP.WR(PC_HL_TBGAS_MCTG_NAOPARADA      , 1);
        //CLP.WR(PC_SL_TBGAS_ATLAS_EMCOASTDOWN   , 1);
        CLP.WR(PC_SL_TBGAS_ATLAS_QUALQUERALARME, 1);
        CLP.WR(PC_SL_TBGAS_ATLAS_QQTRIP        , 1);
        CLP.WR(PC_SL_TBGAS_ATLAS_PRDEMLOCHWTRIP, 1);
        CLP.WR(PC_SL_TBGAS_ATLAS_QQALARME      , 1);
        CLP.WR(PC_HL_TBGAS_MCTG_QQALARME       , 1);
        CLP.WR(PC_HL_TBGAS_MCTG_QQTRIP         , 1);
        CLP.WR(PC_HL_TBGAS_MCTG_PRDEMERG       , 1);
        ack_parar_emergencia = false;
        tmrPartida->Enabled = false;
        em_parada_emerg = true;
        ack_parar_emergencia = true;
        contador_parada = 20;
        em_operacao = false; //teste
        tmrParada->Enabled = true;
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnSilenciarClick(TObject *Sender)
{
        mplAudio->Stop();
        silenciar_sirene = true;
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnResetAckClick(TObject *Sender)
{
        ack_partir_normal = false;
        ack_partir_rapido = false;
        ack_parar_normal = false;
        ack_parar_emergencia = false;
        ack_parar_incendio = false;
        ack_abrir_vod116 = false;
        ack_fechar_vod116 = false;
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::tmrAbrirVOD116Timer(TObject *Sender)
{
         CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODFECH, 0);
         CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODABT , 1);
         ack_abrir_vod116 = false;
         tmrAbrirVOD116->Enabled = false;
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::tmrFecharVOD116Timer(TObject *Sender)
{
        CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODABT , 0);
        CLP.WR(PC_SL_TBGAS_ATLAS_VVEXTODFECH, 1);
        ack_fechar_vod116 = false;
        tmrFecharVOD116->Enabled = false;
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnCaturrarClick(TObject *Sender)
{
        if ( variar_ntp == false ){
                taxa_variacao_ntp = txtCaturrar->Text.ToDouble();
                variar_ntp = true;
                lblNTP->Font->Color = clRed;
        }else{
                variar_ntp = false;
                lblNTP->Font->Color = clBlack;
        }
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnStatusClick(TObject *Sender)
{
        pnlStatus->Visible = true;
        pnlLocal->Visible = false;
        pnlFunc->Visible = false;
        pnlComandos->Visible = false;
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btncmdlocalClick(TObject *Sender)
{
        pnlStatus->Visible = false;
        pnlLocal->Visible = true;
        pnlFunc->Visible = false;
        pnlComandos->Visible = false;
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnCtrlClick(TObject *Sender)
{
        pnlStatus->Visible = false;
        pnlLocal->Visible = false;
        pnlFunc->Visible = true;
        pnlComandos->Visible = false;
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btncmdremotosClick(TObject *Sender)
{
        pnlStatus->Visible = false;
        pnlLocal->Visible = false;
        pnlFunc->Visible = false;
        pnlComandos->Visible = true;
}
//---------------------------------------------------------------------------

void __fastcall TfrmPrincipal::btnFecharClick(TObject *Sender)
{
        frmPrincipal->Close();
}
//---------------------------------------------------------------------------

